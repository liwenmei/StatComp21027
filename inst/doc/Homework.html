<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Li Wenmei" />

<meta name="date" content="2021-12-20" />

<title>Homework</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Li Wenmei</h4>
<h4 class="date">2021-12-20</h4>



<div id="first-homework" class="section level4">
<h4>First homework</h4>
</div>
<div id="question" class="section level3">
<h3>Question</h3>
<p>Exercises 3.3,3.4,3.5(page 94 ,Statistical Computating with R )</p>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
<p>3.3 The Pareto(2,2) distribution has cdf <span class="math inline">\(F(x)=1-(\frac{2}{x})^2,x&gt;2\)</span>,we derive the probability inverse transformation,and use the inverse transform method to simulate a random sample from the Pareto(2,2) distribution. and graph the density histogram of the sample with the Pareto(2,2) density superimposed for comparison.Therefore, it is reasonable for us to obtain the original values of random variables by random sampling of uniform distribution and inverse transformation method, and it is relatively simple to sample uniform distribution, which greatly reduces the difficulty of sampling random variables with complex distribution.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>) </a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(stats)</a>
<a class="sourceLine" id="cb1-3" title="3">r&lt;-<span class="kw">runif</span>(<span class="dv">1000</span>) </a>
<a class="sourceLine" id="cb1-4" title="4">x&lt;-<span class="dv">2</span><span class="op">/</span>((r)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))<span class="co">#  Derive the inverse function</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">*</span>x<span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb1-6" title="6">y&lt;-<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">20</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">lines</span>(y,<span class="dv">8</span><span class="op">*</span>y<span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the histogram and density plot in above figure, we can see that the empirical and theoretical distributions approximately agree.</p>
<p>3.4 Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution.Generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for several choices of <span class="math inline">\(\sigma\)</span> &gt; 0 ,now Might as well set <span class="math inline">\(\sigma\)</span>=1,and checkthat the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>(check the histogram). The Rayleigh(1) distribution has cdf <span class="math inline">\(F(x)=1-e^{-{(\frac{x}{2})^2}}\)</span>, according to the inverse transformation method,we have <span class="math inline">\(x=(-2lnU)^\frac{1}{2}\)</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">u&lt;-<span class="kw">runif</span>(<span class="dv">1000</span>) </a>
<a class="sourceLine" id="cb2-2" title="2">x&lt;-(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(u))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">*</span>e<span class="op">^</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb2-4" title="4">y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb2-5" title="5">y1&lt;-y<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">lines</span>(y,y1,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the histogram and density plot in above figure, we can see that the empirical and theoretical distributions approximately agree.Therefore, it is reasonable for us to obtain the original values of random variables by random sampling of uniform distribution and inverse transformation method, and it is relatively simple to sample uniform distribution, which greatly reduces the difficulty of sampling random variables with complex distribution</p>
<p>3.5 For a discrete random variable X,Use the inverse transform method to generate a random sample of size 1000 from the distribution of X. Construct a relative frequency table and compare the empirical with the theoretical probabilities. Repeat using the R sample function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">p&lt;-<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb3-3" title="3">res&lt;-<span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">p=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>))</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">kable</span>(res,<span class="dt">digits =</span> <span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span> <span class="st">&quot;lccrr&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
<th align="center">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="center">0.1</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="center">0.2</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="center">0.2</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="center">0.2</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="center">0.3</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">x&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">size=</span><span class="dv">1000</span>,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>))</a>
<a class="sourceLine" id="cb4-2" title="2">p0&lt;-<span class="kw">sum</span>(x<span class="op">==</span><span class="dv">0</span>)<span class="op">/</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb4-3" title="3">p1&lt;-<span class="kw">sum</span>(x<span class="op">==</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb4-4" title="4">p2&lt;-<span class="kw">sum</span>(x<span class="op">==</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb4-5" title="5">p3&lt;-<span class="kw">sum</span>(x<span class="op">==</span><span class="dv">3</span>)<span class="op">/</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb4-6" title="6">p4&lt;-<span class="kw">sum</span>(x<span class="op">==</span><span class="dv">4</span>)<span class="op">/</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="kw">data.frame</span>(p0,p1,p2,p3,p4)</a></code></pre></div>
<pre><code>##      p0    p1    p2    p3    p4
## 1 0.092 0.208 0.184 0.197 0.319</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">res1&lt;-<span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dt">t_p=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>),<span class="dt">e_p=</span><span class="kw">c</span>(p0,p1,p2,p3,p4))</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">kable</span>(res1,<span class="dt">digits =</span> <span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span> <span class="st">&quot;lccrr&quot;</span>,<span class="dt">label =</span> <span class="st">&quot;Empirical with the theoretical probabilities &quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
<th align="center">t_p</th>
<th align="center">e_p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="center">0.1</td>
<td align="center">0.092</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="center">0.2</td>
<td align="center">0.208</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="center">0.2</td>
<td align="center">0.184</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="center">0.2</td>
<td align="center">0.197</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="center">0.3</td>
<td align="center">0.319</td>
</tr>
</tbody>
</table>
<p>From the Empirical with the theoretical probabilities table, we can see the empirical probalities and theoretical probabilities approximately agree, because the sample size is very large.As in the continuous case, for discrete random variables, when the sample size is large enough,</p>
<div id="second-homework" class="section level4">
<h4>Second homework</h4>
</div>
</div>
<div id="question-1" class="section level3">
<h3>Question</h3>
<p>Exercises3.4,3.11,and3.20(pages94-96,StatisticalComputaing with R)</p>
<p>3.4 The Rayleigh density [156, Ch. 18] is<span class="math display">\[f(x)={\frac{x}{\sigma^2}}e^{-\frac{x^2}{2\sigma^2}},x\geq0,\sigma\geq0.\]</span> Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for several choices of <span class="math inline">\(\sigma&gt;0\)</span> and checkthat the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span>(check the histogram)</p>
<p>3.11 Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N(0,1) and N(3,1) distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2=1-p_1\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_1=0.75\)</span>. Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_1\)</span> that produce bimodal mixtures.</p>
<p>3.20 A compound Poisson process is a stochastic process<span class="math inline">\(\{X(t),t\geq0\}\)</span> that can be represented as the random sum <span class="math inline">\(X(t)=\sum_{i=0}^{N(t)}Y_i,t\geq0,where \{N(t),t\geq0\}\)</span> is a Poisson process and <span class="math inline">\(Y_1,Y_2,...\)</span> are idd and indenpent of <span class="math inline">\(\{N(t),t\geq0\}\)</span>. Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)-Gamma process (Y has a Gamma distribution). Estimate the mean and the variance of X(10) for several choices of the parameters and compare with the theoretical values. Hint: Show that <span class="math inline">\(E[X(t)]=\lambda{t}E[Y_1]\)</span> and <span class="math inline">\(Var(X(t))=\lambda{E[{Y_1}^2]}\)</span></p>
</div>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<p>3.4 Because we already know the Rayleigh density,We can easily figure out its distribution function <span class="math inline">\(F(x)=1-e^{-\frac{x^2}{2{\sigma}^2}}\)</span>,now we will generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for <span class="math inline">\(\sigma=1,5,10\)</span> and Graph the histogram of the sample with density superimposed.</p>
<p>Algorithm is as follows: (1) for <span class="math inline">\(\sigma=1,5,10\)</span>, the corresponding distribution function is <span class="math inline">\(F_1(x)=1-e^{-\frac{x^2}{2}},F_2(x)=1-e^{-\frac{x^2}{50}},F_3(x)=1-e^{-\frac{x^2}{200}}\)</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">u&lt;-<span class="kw">runif</span>(<span class="dv">1000</span>) <span class="co">#Generate 1000 independent and uniformly distributed random variables</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co"># for sigma=1</span></a>
<a class="sourceLine" id="cb7-5" title="5">x&lt;-(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(u))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#graph the histogram</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">*</span>e<span class="op">^</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>) ))</a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#Graph the density curve</span></a>
<a class="sourceLine" id="cb7-9" title="9">y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb7-10" title="10">y1&lt;-y<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-11" title="11"><span class="kw">lines</span>(y,y1,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># for sigma=5</span></a>
<a class="sourceLine" id="cb8-2" title="2">x1&lt;-(<span class="op">-</span><span class="dv">50</span><span class="op">*</span><span class="kw">log</span>(u))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#graph the histogram</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">hist</span>(x1,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span><span class="dv">25</span><span class="op">*</span>e<span class="op">^</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">50</span>)))</a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#Graph the density curve</span></a>
<a class="sourceLine" id="cb8-6" title="6">y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb8-7" title="7">y1&lt;-y<span class="op">/</span><span class="dv">25</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw">lines</span>(y,y1,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># for sigma=10</span></a>
<a class="sourceLine" id="cb9-2" title="2">x2&lt;-(<span class="op">-</span><span class="dv">200</span><span class="op">*</span><span class="kw">log</span>(u))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#graph the histogram</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">hist</span>(x2,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span><span class="dv">100</span><span class="op">*</span>e<span class="op">^</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">200</span>)))</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co">#Graph the density curve</span></a>
<a class="sourceLine" id="cb9-6" title="6">y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb9-7" title="7">y1&lt;-y<span class="op">/</span><span class="dv">100</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">200</span>)</a>
<a class="sourceLine" id="cb9-8" title="8"><span class="kw">lines</span>(y,y1,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As can be seen from the above three figures, for sigma=1,5,10, the histogram of the sample obtained by the inverse transformation method is consistent with its density curve, so the random samples generated from the model follow the theoretical distribution.</p>
<p>3.11 We generate random numbers directly from two normal distributions and obtain the mixed distribution as follows.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb10-3" title="3">z&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">length</span>(n))</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">## for p1=0.75</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb10-6" title="6">{</a>
<a class="sourceLine" id="cb10-7" title="7"> u&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-8" title="8">  <span class="cf">if</span>(u<span class="op">&lt;</span><span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb10-9" title="9">   z[i]=<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-10" title="10">  <span class="cf">else</span> </a>
<a class="sourceLine" id="cb10-11" title="11">    z[i]=<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-12" title="12">}</a>
<a class="sourceLine" id="cb10-13" title="13"><span class="kw">hist</span>(z,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="dt">mixture_distribution_p1=</span><span class="fl">0.75</span>))</a>
<a class="sourceLine" id="cb10-14" title="14">y&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">100</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb10-15" title="15">y1&lt;-(<span class="fl">0.75</span><span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>pi)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span>(<span class="fl">0.25</span><span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>pi)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>((y<span class="dv">-3</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-16" title="16"><span class="kw">lines</span>(y,y1,<span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">## we will consider the other value of p1</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co"># p1=0.9,then we have</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb11-4" title="4">{</a>
<a class="sourceLine" id="cb11-5" title="5"> u&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-6" title="6">  <span class="cf">if</span>(u<span class="op">&lt;</span><span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb11-7" title="7">   z[i]=<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-8" title="8">  <span class="cf">else</span> </a>
<a class="sourceLine" id="cb11-9" title="9">    z[i]=<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-10" title="10">}</a>
<a class="sourceLine" id="cb11-11" title="11"><span class="kw">hist</span>(z,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="dt">mixture_distribution_p1=</span><span class="fl">0.9</span>))</a>
<a class="sourceLine" id="cb11-12" title="12">y&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">100</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb11-13" title="13">y1&lt;-(<span class="fl">0.9</span><span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>pi)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span>(<span class="fl">0.1</span><span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>pi)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>((y<span class="dv">-3</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-14" title="14"><span class="kw">lines</span>(y,y1,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># p1=0.5,then we have</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb12-3" title="3">{</a>
<a class="sourceLine" id="cb12-4" title="4"> u&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-5" title="5">  <span class="cf">if</span>(u<span class="op">&lt;</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb12-6" title="6">   z[i]=<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-7" title="7">  <span class="cf">else</span> </a>
<a class="sourceLine" id="cb12-8" title="8">    z[i]=<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-9" title="9">}</a>
<a class="sourceLine" id="cb12-10" title="10"><span class="kw">hist</span>(z,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="dt">mixture_distribution_p1=</span><span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb12-11" title="11">y&lt;-<span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">100</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb12-12" title="12">y1&lt;-(<span class="fl">0.5</span><span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>pi)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span>(<span class="fl">0.5</span><span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>pi)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>((y<span class="dv">-3</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-13" title="13"><span class="kw">lines</span>(y,y1,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As can be seen from the above three histograms, the smaller the difference between <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> is, the more obvious the bimodal of the mixed distribution is. When the difference between <span class="math inline">\(P_1\)</span> and <span class="math inline">\(P_2\)</span> is larger, the histogram shows that the bimodal of the mixed distribution is not obvious. For example, in the second picture, <span class="math inline">\(p_1=0.9\)</span>, <span class="math inline">\(p_2=0.1\)</span>, and the histogram almost presents a single peak.</p>
<p>3.20 So lets say <span class="math inline">\(\lambda=2\)</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">lambda &lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb13-3" title="3">t0&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb13-4" title="4">supper&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb13-5" title="5">N_t&lt;-<span class="kw">numeric</span>(<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb13-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) {</a>
<a class="sourceLine" id="cb13-7" title="7">N&lt;-<span class="kw">rpois</span>(<span class="dv">1</span>,lambda<span class="op">*</span>supper)</a>
<a class="sourceLine" id="cb13-8" title="8">Un&lt;-<span class="kw">runif</span>(N,<span class="dv">0</span>,supper) <span class="co">#unordered arrival times</span></a>
<a class="sourceLine" id="cb13-9" title="9">Sn&lt;-<span class="kw">sort</span>(Un) <span class="co">#arrival times</span></a>
<a class="sourceLine" id="cb13-10" title="10">n &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(Sn<span class="op">&gt;</span>t0)) <span class="co">#arrivals+1 in [0, t0]</span></a>
<a class="sourceLine" id="cb13-11" title="11">N_t[i] &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="co">#arrivals in [0, t0]</span></a>
<a class="sourceLine" id="cb13-12" title="12">}</a>
<a class="sourceLine" id="cb13-13" title="13">N_<span class="dv">10</span>=<span class="kw">ceiling</span>(<span class="kw">mean</span>(N_t))</a>
<a class="sourceLine" id="cb13-14" title="14">N_<span class="dv">10</span></a></code></pre></div>
<pre><code>## [1] 21</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">x&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">length</span>(<span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb15-3" title="3">{</a>
<a class="sourceLine" id="cb15-4" title="4">  y&lt;-<span class="st"> </span><span class="kw">rgamma</span>(N_<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb15-5" title="5">  x[i]&lt;-<span class="kw">sum</span>(y)</a>
<a class="sourceLine" id="cb15-6" title="6">}</a>
<a class="sourceLine" id="cb15-7" title="7">Y&lt;-<span class="st"> </span><span class="kw">rgamma</span>(N_<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb15-8" title="8">res&lt;-<span class="kw">data.frame</span>(<span class="kw">mean</span>(x),lambda<span class="op">*</span>t0<span class="op">*</span><span class="fl">0.8</span>,<span class="kw">var</span>(x),lambda<span class="op">*</span>t0<span class="op">*</span><span class="dv">4</span><span class="op">/</span><span class="dv">25</span>)</a>
<a class="sourceLine" id="cb15-9" title="9"><span class="kw">kable</span>(res,<span class="dt">digits =</span> <span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span> <span class="st">&quot;lccrr&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">mean.x.</th>
<th align="center">lambdat00.8</th>
<th align="center">var.x.</th>
<th align="right">lambdat04.25</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">16.84854</td>
<td align="center">16</td>
<td align="center">3.272266</td>
<td align="right">3.2</td>
</tr>
</tbody>
</table>
<p>As can be seen from the final output of the model,both the equation <span class="math inline">\(E[X(t)]=\lambda{t}E[Y_1]\)</span> and the equaton <span class="math inline">\(Var(X(t)) =\lambda{E[{Y_1}^2]}\)</span> is hold on, so the sampling method we adopted is feasible.</p>
<div id="third-homework" class="section level4">
<h4>Third homework</h4>
</div>
</div>
<div id="question-5.4" class="section level3">
<h3>Question 5.4</h3>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3,3) cdf, and use the function to estimate F(x) for x = 0.1, 0.2,, 0.9. Compare the estimates with the values returned by the pbeta function in R.</p>
</div>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">beta_cdf&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb16-2" title="2">  n&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb16-3" title="3">  t&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,x)</a>
<a class="sourceLine" id="cb16-4" title="4">  theta.hat&lt;-<span class="kw">mean</span>(t<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>t)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>)<span class="op">*</span>x)</a>
<a class="sourceLine" id="cb16-5" title="5">  <span class="kw">return</span>(theta.hat)</a>
<a class="sourceLine" id="cb16-6" title="6">}</a>
<a class="sourceLine" id="cb16-7" title="7">Monte_Carlo_estimate&lt;-<span class="kw">numeric</span>(<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb16-8" title="8">Beta_cdf&lt;-<span class="kw">numeric</span>(<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb16-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>){</a>
<a class="sourceLine" id="cb16-10" title="10">  Monte_Carlo_estimate[i]=<span class="kw">beta_cdf</span>(i<span class="op">*</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb16-11" title="11">  Beta_cdf[i]=<span class="kw">pbeta</span>(i<span class="op">*</span><span class="fl">0.1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb16-12" title="12">}</a>
<a class="sourceLine" id="cb16-13" title="13">res&lt;-<span class="kw">data.frame</span>(Monte_Carlo_estimate,Beta_cdf)</a>
<a class="sourceLine" id="cb16-14" title="14"><span class="kw">kable</span>(res,<span class="dt">digits =</span> <span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span> <span class="st">&quot;lccrr&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Monte_Carlo_estimate</th>
<th align="center">Beta_cdf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0.0085301</td>
<td align="center">0.00856</td>
</tr>
<tr class="even">
<td align="left">0.0577243</td>
<td align="center">0.05792</td>
</tr>
<tr class="odd">
<td align="left">0.1620946</td>
<td align="center">0.16308</td>
</tr>
<tr class="even">
<td align="left">0.3171129</td>
<td align="center">0.31744</td>
</tr>
<tr class="odd">
<td align="left">0.5005384</td>
<td align="center">0.50000</td>
</tr>
<tr class="even">
<td align="left">0.6800389</td>
<td align="center">0.68256</td>
</tr>
<tr class="odd">
<td align="left">0.8405293</td>
<td align="center">0.83692</td>
</tr>
<tr class="even">
<td align="left">0.9536735</td>
<td align="center">0.94208</td>
</tr>
<tr class="odd">
<td align="left">0.9889481</td>
<td align="center">0.99144</td>
</tr>
</tbody>
</table>
<p>From the table we can clear see, by comparing the estimates with the values return by the pbeta function in R,the Monte Carlo estimate of the Beta(3,3) cdf is approximately to the real cdf of Beta(3,3)</p>
</div>
<div id="question-5.9" class="section level3">
<h3>Question 5.9</h3>
<p>The Rayleigh density [156, (18.76)] is<span class="math display">\[f(x)={\frac{x}{{\sigma}^2}}e^{-{\frac{x^2}{2{\sigma}^2}}},x\geq0,\sigma\geq0.\]</span>Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution,using antithetic variables. What is the percent reduction in variance of<span class="math inline">\({\frac{x+x&#39;}{2}}\)</span>compared with<span class="math inline">\({\frac{x_1+x_2}{2}}\)</span>for independent <span class="math inline">\(x_1,x_2\)</span>?</p>
</div>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<p>In this example the target parameter is <span class="math inline">\(\theta=xE_U[{\frac{t}{{\sigma}^2}e^{-\frac{U^2}{2\sigma^2}}}]\)</span>,U~U(0,x).now,we will discuss sevel situation,<span class="math inline">\(\sigma=1,2,3,4,5\)</span></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">###using antithetic variables</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb17-3" title="3">Mc&lt;-<span class="cf">function</span>(x,m,<span class="dt">R=</span><span class="dv">10000</span>,<span class="dt">antithetic=</span><span class="ot">TRUE</span>)<span class="co">##,and the m is parameter.</span></a>
<a class="sourceLine" id="cb17-4" title="4">  {</a>
<a class="sourceLine" id="cb17-5" title="5">  u&lt;-<span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-6" title="6">  <span class="cf">if</span>(<span class="op">!</span>antithetic)v&lt;-<span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb17-7" title="7">  <span class="cf">else</span> v&lt;-<span class="dv">1</span><span class="op">-</span>u</a>
<a class="sourceLine" id="cb17-8" title="8">  t&lt;-<span class="kw">c</span>(u,v)</a>
<a class="sourceLine" id="cb17-9" title="9">  theta_hat&lt;-<span class="kw">mean</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>t<span class="op">/</span>m<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>t<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>m<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb17-10" title="10">}</a>
<a class="sourceLine" id="cb17-11" title="11">k&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb17-12" title="12">Mc1&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb17-13" title="13">Mc2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb17-14" title="14">Mc3&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb17-15" title="15">Mc4&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb17-16" title="16">Mc5&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb17-17" title="17">x&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb17-18" title="18">m&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb17-19" title="19">sigma&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb17-20" title="20"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb17-21" title="21"> {</a>
<a class="sourceLine" id="cb17-22" title="22">      Mc1[j]&lt;-<span class="kw">Mc</span>(x[<span class="dv">1</span>],m[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb17-23" title="23">      Mc2[j]&lt;-<span class="kw">Mc</span>(x[<span class="dv">2</span>],m[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb17-24" title="24">      Mc3[j]&lt;-<span class="kw">Mc</span>(x[<span class="dv">3</span>],m[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb17-25" title="25">      Mc4[j]&lt;-<span class="kw">Mc</span>(x[<span class="dv">4</span>],m[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb17-26" title="26">      Mc5[j]&lt;-<span class="kw">Mc</span>(x[<span class="dv">5</span>],m[<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb17-27" title="27">}</a>
<a class="sourceLine" id="cb17-28" title="28"></a>
<a class="sourceLine" id="cb17-29" title="29">antithetic_variables&lt;-<span class="kw">c</span>(<span class="kw">var</span>(Mc1),<span class="kw">var</span>(Mc2),<span class="kw">var</span>(Mc3),<span class="kw">var</span>(Mc4),<span class="kw">var</span>(Mc5))</a>
<a class="sourceLine" id="cb17-30" title="30"><span class="co">####for the independent variables</span></a>
<a class="sourceLine" id="cb17-31" title="31">MC_independent&lt;-<span class="cf">function</span>(x,m,<span class="dt">R=</span><span class="dv">10000</span>)<span class="co">##,and the m is parameter.</span></a>
<a class="sourceLine" id="cb17-32" title="32">  {</a>
<a class="sourceLine" id="cb17-33" title="33">  u&lt;-<span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-34" title="34">  v&lt;-<span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-35" title="35">  theta_hat&lt;-<span class="kw">mean</span>(x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>u<span class="op">/</span>m<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>m<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>v<span class="op">/</span>m<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>v<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span><span class="op">/</span>m<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb17-36" title="36">}</a>
<a class="sourceLine" id="cb17-37" title="37">Mc6&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb17-38" title="38">Mc7&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb17-39" title="39">Mc8&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb17-40" title="40">Mc9&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb17-41" title="41">Mc10&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb17-42" title="42"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb17-43" title="43"> {</a>
<a class="sourceLine" id="cb17-44" title="44">      Mc6[j]&lt;-<span class="kw">MC_independent</span>(x[<span class="dv">1</span>],m[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb17-45" title="45">      Mc7[j]&lt;-<span class="kw">MC_independent</span>(x[<span class="dv">2</span>],m[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb17-46" title="46">      Mc8[j]&lt;-<span class="kw">MC_independent</span>(x[<span class="dv">3</span>],m[<span class="dv">3</span>])</a>
<a class="sourceLine" id="cb17-47" title="47">      Mc9[j]&lt;-<span class="kw">MC_independent</span>(x[<span class="dv">4</span>],m[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb17-48" title="48">      Mc10[j]&lt;-<span class="kw">MC_independent</span>(x[<span class="dv">5</span>],m[<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb17-49" title="49">}</a>
<a class="sourceLine" id="cb17-50" title="50">independent_variables&lt;-<span class="kw">c</span>(<span class="kw">var</span>(Mc6),<span class="kw">var</span>(Mc7),<span class="kw">var</span>(Mc8),<span class="kw">var</span>(Mc9),<span class="kw">var</span>(Mc10))</a>
<a class="sourceLine" id="cb17-51" title="51">variance_reduction_percent&lt;-<span class="kw">c</span>((<span class="kw">var</span>(Mc6)<span class="op">-</span><span class="kw">var</span>(Mc1))<span class="op">/</span><span class="kw">var</span>(Mc6),(<span class="kw">var</span>(Mc7)<span class="op">-</span><span class="kw">var</span>(Mc2))<span class="op">/</span><span class="kw">var</span>(Mc7),(<span class="kw">var</span>(Mc8)<span class="op">-</span><span class="kw">var</span>(Mc3))<span class="op">/</span><span class="kw">var</span>(Mc8),(<span class="kw">var</span>(Mc9)<span class="op">-</span><span class="kw">var</span>(Mc4))<span class="op">/</span><span class="kw">var</span>(Mc9),(<span class="kw">var</span>(Mc10)<span class="op">-</span><span class="kw">var</span>(Mc5))<span class="op">/</span><span class="kw">var</span>(Mc10))</a>
<a class="sourceLine" id="cb17-52" title="52">res&lt;-<span class="kw">data.frame</span>(x,sigma,antithetic_variables,independent_variables,variance_reduction_percent)</a>
<a class="sourceLine" id="cb17-53" title="53"><span class="kw">kable</span>(res,<span class="dt">digits =</span> <span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span> <span class="st">&quot;lccrr&quot;</span>)</a></code></pre></div>
<table>
<colgroup>
<col width="3%"></col>
<col width="8%"></col>
<col width="27%"></col>
<col width="27%"></col>
<col width="33%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">x</th>
<th align="center">sigma</th>
<th align="center">antithetic_variables</th>
<th align="right">independent_variables</th>
<th align="right">variance_reduction_percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="center">1</td>
<td align="center">4e-07</td>
<td align="right">1.42e-05</td>
<td align="right">0.9753042</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="center">2</td>
<td align="center">3e-07</td>
<td align="right">1.40e-05</td>
<td align="right">0.9764651</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="center">3</td>
<td align="center">4e-07</td>
<td align="right">1.34e-05</td>
<td align="right">0.9735751</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="center">4</td>
<td align="center">3e-07</td>
<td align="right">1.48e-05</td>
<td align="right">0.9776701</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="center">5</td>
<td align="center">3e-07</td>
<td align="right">1.43e-05</td>
<td align="right">0.9770659</td>
</tr>
</tbody>
</table>
<p>For this exam,we consider x=i,<span class="math inline">\(\sigma=i,i=1,...,5\)</span> five kinds of situations, we always have the percent reduction in variance of<span class="math inline">\({\frac{x+x&#39;}{2}}\)</span> compared with <span class="math inline">\({\frac{x_1+x_2}{2}}\)</span>for independent <span class="math inline">\(x_1,x_2\)</span> is nearly 97%</p>
</div>
<div id="question-5.13" class="section level3">
<h3>Question 5.13</h3>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are close to <span class="math display">\[g(x)={\frac{x^2}{\sqrt{2\pi}}}e^{-\frac{x^2}{2}},x\geq0.\]</span>Which of your two importance functions should produce the smaller variance in estimating<span class="math display">\[\int_1^\infty{\frac{x^2}{\sqrt{2\pi}}}e^{-\frac{x^2}{2}}dx\]</span>by importance sampling? Explain.</p>
</div>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<p>For this case, we will consider <span class="math inline">\(f_1(x)={\frac{1}{\sqrt{2\pi}}}e^{-\frac{x^2}{2}},f_2(x)=xe^{-\frac{x^2}{2}}\)</span>, both <span class="math inline">\(f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span> are density function, and <span class="math inline">\(f_1(x)&gt;0,f_2(x)&gt;0\)</span> for all x belong to <span class="math inline">\((1,\infty)\)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"> x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb18-2" title="2">g&lt;-x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-3" title="3">f1&lt;-<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-4" title="4">f2&lt;-x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-5" title="5">gs &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb18-6" title="6">            <span class="kw">expression</span>(<span class="kw">g</span>(x)<span class="op">==</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb18-7" title="7">            <span class="kw">expression</span>(f[<span class="dv">1</span>](x)<span class="op">==</span><span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb18-8" title="8">            <span class="kw">expression</span>(f[<span class="dv">2</span>](x)<span class="op">==</span>x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb18-9" title="9">            )</a>
<a class="sourceLine" id="cb18-10" title="10"> <span class="kw">plot</span>(x,g,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb18-11" title="11">         <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">1</span>,<span class="dt">main=</span><span class="st">&#39;(A)&#39;</span>)</a>
<a class="sourceLine" id="cb18-12" title="12">    <span class="kw">lines</span>(x, f1, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-13" title="13">    <span class="kw">lines</span>(x, f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb18-14" title="14"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> gs,</a>
<a class="sourceLine" id="cb18-15" title="15">           <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">inset=</span><span class="fl">0.02</span>,<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As can be seen from the figure above, the image of <span class="math inline">\(f_2(x)\)</span> and g(x) is closer, so selecting <span class="math inline">\(f_2(x)\)</span> as an important function can produce smaller variance than selecting <span class="math inline">\(f_1(x)\)</span> as an important function.</p>
</div>
<div id="question-5.14" class="section level3">
<h3>Question 5.14</h3>
<p>Obtain a Monte Carlo estimate of<span class="math display">\[\int_1^\infty{\frac{x^2}{\sqrt{2\pi}}}e^{-\frac{x^2}{2}}dx\]</span>by importance sampling.</p>
</div>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<p>According to problem 5.13, we consider integrals of functions <span class="math inline">\(f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span> as important functions respectively.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co">### now we will compute the intergation </span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb19-3" title="3">m&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb19-4" title="4">  est&lt;-sd&lt;-<span class="kw">numeric</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-5" title="5">  g&lt;-<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb19-6" title="6"> x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-7" title="7">  }</a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co">### for the f1(x)</span></a>
<a class="sourceLine" id="cb19-9" title="9">x&lt;-<span class="kw">rnorm</span>(m)</a>
<a class="sourceLine" id="cb19-10" title="10">  fg&lt;-<span class="kw">g</span>(x)<span class="op">/</span>(<span class="dv">1</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb19-11" title="11">  est[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb19-12" title="12">  sd[<span class="dv">1</span>]&lt;-<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb19-13" title="13"><span class="co">### for the f2(x)</span></a>
<a class="sourceLine" id="cb19-14" title="14">u&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb19-15" title="15">x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(u))</a>
<a class="sourceLine" id="cb19-16" title="16">fg&lt;-<span class="kw">g</span>(x)<span class="op">/</span>(x<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb19-17" title="17">  est[<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb19-18" title="18">  sd[<span class="dv">2</span>]&lt;-<span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb19-19" title="19">  res&lt;-<span class="kw">rbind</span>(<span class="dt">est=</span><span class="kw">round</span>(est,<span class="dv">3</span>), <span class="dt">sd=</span><span class="kw">round</span>(sd,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb19-20" title="20">  <span class="kw">colnames</span>(res)&lt;-<span class="kw">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-21" title="21"> knitr<span class="op">::</span><span class="kw">kable</span>(res,<span class="dt">digits =</span> <span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span> <span class="st">&quot;lccrr&quot;</span>) </a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">f1</th>
<th align="center">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">est</td>
<td align="left">0.400</td>
<td align="center">0.401</td>
</tr>
<tr class="even">
<td align="left">sd</td>
<td align="left">1.108</td>
<td align="center">0.358</td>
</tr>
</tbody>
</table>
<p>The results in the table above show that our judgment in Example 5.13 is correct, and the Monte Carlo estimate of <span class="math inline">\(\int_1^\infty{\frac{x^2}{\sqrt{2\pi}}}e^{-\frac{x^2}{2}}dx\)</span> by importance sampling is about 0.4.</p>
<div id="forth-homework" class="section level4">
<h4>Forth homework</h4>
</div>
</div>
<div id="question-6.5" class="section level3">
<h3>Question 6.5</h3>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">####Now we will compute the probability that the confidence interval covers in example 6.4</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co">## we use sample which are normal</span></a>
<a class="sourceLine" id="cb20-4" title="4">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb20-5" title="5">alpha &lt;-.<span class="dv">05</span></a>
<a class="sourceLine" id="cb20-6" title="6">UCL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb20-7" title="7">x&lt;-<span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-8" title="8">(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(alpha,<span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb20-9" title="9">} )</a>
<a class="sourceLine" id="cb20-10" title="10"><span class="co">#or compute the mean to get the confidence level</span></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="kw">print</span>(<span class="st">&quot;the coverage probability of the t-interval for variance which sample are normal&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;the coverage probability of the t-interval for variance which sample are normal&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.94</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="co">###we use sample which are non-normal</span></a>
<a class="sourceLine" id="cb24-2" title="2">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb24-3" title="3">alpha &lt;-.<span class="dv">05</span></a>
<a class="sourceLine" id="cb24-4" title="4">UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb24-5" title="5">x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb24-6" title="6">(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(alpha,<span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb24-7" title="7">} )</a>
<a class="sourceLine" id="cb24-8" title="8"><span class="co">#or compute the mean to get the confidence level</span></a>
<a class="sourceLine" id="cb24-9" title="9"><span class="kw">print</span>(<span class="st">&quot;the coverage probability of the t-interval for variance which sample are non-normal&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;the coverage probability of the t-interval for variance which sample are non-normal&quot;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.776</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co">####Now we will compute the probability that the confidence interval covers in this case</span></a>
<a class="sourceLine" id="cb28-2" title="2">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb28-3" title="3">CL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb28-4" title="4">   x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>) </a>
<a class="sourceLine" id="cb28-5" title="5">   <span class="kw">sqrt</span>(n)<span class="op">*</span>(<span class="kw">mean</span>(x)<span class="op">-</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb28-6" title="6">} )</a>
<a class="sourceLine" id="cb28-7" title="7">In&lt;-<span class="kw">mean</span>((CL<span class="op">&gt;</span>(<span class="op">-</span><span class="kw">qt</span>(<span class="fl">0.025</span>,n<span class="dv">-1</span>,<span class="dt">lower.tail=</span>F)))<span class="op">&amp;</span>(CL<span class="op">&lt;</span><span class="kw">qt</span>(<span class="fl">0.025</span>,n<span class="dv">-1</span>,<span class="dt">lower.tail =</span> F)))</a>
<a class="sourceLine" id="cb28-8" title="8"><span class="kw">print</span>(<span class="st">&quot;the coverage probability of the t-interval for mean which sample are non-normal:&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;the coverage probability of the t-interval for mean which sample are non-normal:&quot;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">print</span>(In)</a></code></pre></div>
<pre><code>## [1] 0.959</code></pre>
<p>From the result above,we can see, for the non-normal sample, if we use a 95.9% symmetric t-interval to estimate the mean, as in this case, we have 96.1% of the intervals contained the population mean, although our samples are non-normal. Comparing to the example 6.4, if we use sample are normal, we have 94% of the interval contained the population variance, if the samples are non-normal, we still use a t-interval to estimate the variance, then we only 77.6% of the intervals contained the population variance. we confirm the truth t-interval should be more robust to departures from normality than the interval for variance.</p>
</div>
<div id="question-6.a" class="section level3">
<h3>Question 6.A</h3>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level<span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is</p>
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(\chi^2(1)\)</span> (ii)<span class="math inline">\(Uniform(0,2)\)</span> (iii)<span class="math inline">\(Exponential(1)\)</span>.</li>
</ol>
<p>In each case, test <span class="math inline">\(H_0:\mu=\mu_0\)</span> vs <span class="math inline">\(H_0:\mu\neq\mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<p>The mean of each of these distributions is 1.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb32-3" title="3"><span class="co">##(i)chi-square</span></a>
<a class="sourceLine" id="cb32-4" title="4">n &lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb32-5" title="5">alpha &lt;-.<span class="dv">05</span></a>
<a class="sourceLine" id="cb32-6" title="6">mu0&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb32-7" title="7">sigma &lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb32-8" title="8">x_hat&lt;-x_se &lt;-<span class="st"> </span><span class="kw">numeric</span>()</a>
<a class="sourceLine" id="cb32-9" title="9">p.hat&lt;-se.hat&lt;-p_value&lt;-Mc_Simulation&lt;-<span class="kw">numeric</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb32-10" title="10">m&lt;-<span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb32-11" title="11">p&lt;-<span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb32-12" title="12"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb32-13" title="13">x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-14" title="14">ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb32-15" title="15">p[j]&lt;-ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb32-16" title="16">x_hat[j] &lt;-<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb32-17" title="17">x_se[j] &lt;-<span class="st"> </span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb32-18" title="18">}</a>
<a class="sourceLine" id="cb32-19" title="19">p2&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(<span class="kw">sqrt</span>(n)<span class="op">*</span>(x_hat<span class="op">-</span>mu0)<span class="op">/</span>x_se),<span class="dt">df=</span>n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb32-20" title="20">Mc_Simulation[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(p2<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="co">#we obtain the tle by Monte Carlo simulation</span></a>
<a class="sourceLine" id="cb32-21" title="21">p_value[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(p)<span class="co">##p-value, help judge whether we should reject null hypothesis</span></a>
<a class="sourceLine" id="cb32-22" title="22">p.hat[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span>alpha)<span class="co">#we obtain the tle by using t.test </span></a>
<a class="sourceLine" id="cb32-23" title="23">se.hat[<span class="dv">1</span>]&lt;-<span class="kw">sqrt</span>(p.hat[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat[<span class="dv">1</span>])<span class="op">/</span>m)<span class="co">#standard error</span></a>
<a class="sourceLine" id="cb32-24" title="24"></a>
<a class="sourceLine" id="cb32-25" title="25"><span class="co">##(ii)Uniform(0,2)</span></a>
<a class="sourceLine" id="cb32-26" title="26">n&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb32-27" title="27">alpha &lt;-.<span class="dv">05</span></a>
<a class="sourceLine" id="cb32-28" title="28">mu0&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb32-29" title="29">sigma&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb32-30" title="30">m&lt;-<span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb32-31" title="31">p&lt;-<span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb32-32" title="32"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb32-33" title="33">x&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb32-34" title="34">ttest&lt;-<span class="kw">t.test</span>(x,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb32-35" title="35">p[j]&lt;-ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb32-36" title="36">x_hat[j]&lt;-<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb32-37" title="37">x_se[j]&lt;-<span class="st"> </span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb32-38" title="38"></a>
<a class="sourceLine" id="cb32-39" title="39">}</a>
<a class="sourceLine" id="cb32-40" title="40">p_value[<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(p)<span class="co">##p-value, help judge whether we should reject null hypothesis</span></a>
<a class="sourceLine" id="cb32-41" title="41">p.hat[<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span>alpha)<span class="co">#we obtain the tle by using t.test</span></a>
<a class="sourceLine" id="cb32-42" title="42">se.hat[<span class="dv">2</span>]&lt;-<span class="kw">sqrt</span>(p.hat[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat[<span class="dv">2</span>])<span class="op">/</span>m)<span class="co">#standard error</span></a>
<a class="sourceLine" id="cb32-43" title="43">p2&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(<span class="kw">sqrt</span>(n)<span class="op">*</span>(x_hat<span class="op">-</span>mu0)<span class="op">/</span>x_se),<span class="dt">df=</span>n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb32-44" title="44">Mc_Simulation[<span class="dv">2</span>]&lt;-<span class="kw">mean</span>(p2<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="co">#we obtain the tle by Monte Carlo simulation</span></a>
<a class="sourceLine" id="cb32-45" title="45"></a>
<a class="sourceLine" id="cb32-46" title="46"><span class="co">##(iii)exp(1)</span></a>
<a class="sourceLine" id="cb32-47" title="47">n &lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb32-48" title="48">alpha &lt;-.<span class="dv">05</span></a>
<a class="sourceLine" id="cb32-49" title="49">mu0&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb32-50" title="50">sigma &lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb32-51" title="51">m&lt;-<span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb32-52" title="52">p&lt;-<span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb32-53" title="53"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb32-54" title="54">x&lt;-<span class="kw">rexp</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-55" title="55">ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb32-56" title="56">p[j]&lt;-ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb32-57" title="57">x_hat[j] &lt;-<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb32-58" title="58">x_se[j] &lt;-<span class="st"> </span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb32-59" title="59">}</a>
<a class="sourceLine" id="cb32-60" title="60">p_value[<span class="dv">3</span>]&lt;-<span class="kw">mean</span>(p)<span class="co">##p-value, help judge whether we should reject null hypothesis</span></a>
<a class="sourceLine" id="cb32-61" title="61">p.hat[<span class="dv">3</span>]&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span>alpha)<span class="co">#we obtain the tle by using t.test</span></a>
<a class="sourceLine" id="cb32-62" title="62">se.hat[<span class="dv">3</span>]&lt;-<span class="kw">sqrt</span>(p.hat[<span class="dv">3</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat[<span class="dv">3</span>])<span class="op">/</span>m)<span class="co">#standard error</span></a>
<a class="sourceLine" id="cb32-63" title="63">p2&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">abs</span>(<span class="kw">sqrt</span>(n)<span class="op">*</span>(x_hat<span class="op">-</span>mu0)<span class="op">/</span>x_se),<span class="dt">df=</span>n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb32-64" title="64">Mc_Simulation[<span class="dv">3</span>]&lt;-<span class="kw">mean</span>(p2<span class="op">&lt;</span><span class="fl">0.05</span>)<span class="co">#we obtain the tle by Monte Carlo simulation</span></a>
<a class="sourceLine" id="cb32-65" title="65"></a>
<a class="sourceLine" id="cb32-66" title="66">res&lt;-<span class="kw">rbind</span>(<span class="dt">Mc_Simulation=</span><span class="kw">round</span>(Mc_Simulation,<span class="dv">4</span>),<span class="dt">p.hat=</span><span class="kw">round</span>(p.hat,<span class="dv">4</span>),<span class="dt">se.hat=</span><span class="kw">round</span>(se.hat,<span class="dv">4</span>),<span class="dt">p_value=</span><span class="kw">round</span>(p_value,<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb32-67" title="67"><span class="kw">colnames</span>(res)&lt;-<span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;chi-square&quot;</span>,<span class="st">&quot;Uniform&quot;</span>,<span class="st">&quot;Exponential&quot;</span>))</a>
<a class="sourceLine" id="cb32-68" title="68"><span class="kw">kable</span>(res,<span class="dt">digits =</span> <span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span> <span class="st">&quot;lccrr&quot;</span>) </a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">chi-square</th>
<th align="center">Uniform</th>
<th align="center">Exponential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mc_Simulation</td>
<td align="left">0.0633</td>
<td align="center">0.0485</td>
<td align="center">0.0578</td>
</tr>
<tr class="even">
<td align="left">p.hat</td>
<td align="left">0.0633</td>
<td align="center">0.0486</td>
<td align="center">0.0578</td>
</tr>
<tr class="odd">
<td align="left">se.hat</td>
<td align="left">0.0024</td>
<td align="center">0.0022</td>
<td align="center">0.0023</td>
</tr>
<tr class="even">
<td align="left">p_value</td>
<td align="left">0.4929</td>
<td align="center">0.5028</td>
<td align="center">0.4963</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co">#&quot;chi-square&quot;,&quot;Uniform&quot;,&quot;Exponential&quot;</span></a></code></pre></div>
<p>In the table above, the observed Type I error rate of Uniform distribution is 0.0486, which is very close to <span class="math inline">\(\alpha=0.05\)</span>, and the standard deviation is only 0.022. The Type I error rate of the other two distributions are significantly different from 0.05 because of less than standard error. As can be seen from the results of the table, for the test of the mean values of the three distributions, the null hypothesis is accepted and the mean values are all 1, since the P values are all larger than the Type I error rate.</p>
</div>
<div id="question-2" class="section level3">
<h3>Question</h3>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level. (1)What is the corresponding hypothesis test problem? (2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why? (3)Please provide the least necessary information for hypothesis testing</p>
</div>
<div id="answer-8" class="section level3">
<h3>Answer</h3>
<ol style="list-style-type: decimal">
<li><p>Now we denote the powers for two methods as <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>, then the corresponding hypothesis test problem is:<span class="math inline">\(H_0:p_1=p_2\)</span> vs <span class="math inline">\(H_1:p_1{\neq}p_2\)</span></p></li>
<li><p>Were testing the same sample here, the power of two methods use the same sample is not independent, so we can not use two-sample t-test. When the sample size is large, the mean value of significance test follows a normal distribution, then we can use these two methods in the approximate level. For the McNemar test, which is good at dealing with this case as it doesnt need to know the distribution.</p></li>
<li><p>In this case, we already know the number of experiments and the value of the power. In order to conduct this test, we need to know the significance of both methods for each sample.</p></li>
</ol>
<div id="fifth-homework" class="section level4">
<h4>Fifth homework</h4>
</div>
</div>
<div id="question-6.c" class="section level3">
<h3>Question 6.C</h3>
<p>Repeat Examples 6.8 and 6.10 for Mardias multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math inline">\(\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\)</span>. Under normality,<span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is<span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^{n}((X_i-\overline{X})^T\hat\Sigma^{-1}(X_j-\overline{X}))^3\]</span> where <span class="math inline">\(\hat\Sigma\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with d(d+1)(d+2)/6 degrees of freedom.</p>
</div>
<div id="answer-9" class="section level3">
<h3>Answer</h3>
<p>Now, we wil consider the case which d=3, <span class="math inline">\(X\)</span>~<span class="math inline">\(N_3(\mu,\Sigma)\)</span>,<span class="math display">\[\mu=(0,0,0),\Sigma=\begin{bmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\end{bmatrix}\quad\]</span></p>
</div>
<div id="section" class="section level3">
<h3>(1)</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">n&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>) <span class="co">#sample sizes</span></a>
<a class="sourceLine" id="cb34-2" title="2">d&lt;-<span class="dv">3</span></a>
<a class="sourceLine" id="cb34-3" title="3">v1&lt;-<span class="kw">qchisq</span>(<span class="fl">0.95</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>) <span class="co">##Chi squared quantiles</span></a></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co">### sk funcion  return 0 when we accept H0, return 1 when we reject H0</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb35-3" title="3">sk&lt;-<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb35-4" title="4">r&lt;-<span class="kw">nrow</span>(x) <span class="co">## we use r to note the sample size</span></a>
<a class="sourceLine" id="cb35-5" title="5">x_center&lt;-x <span class="co"># we will center x</span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d)  </a>
<a class="sourceLine" id="cb35-7" title="7">{</a>
<a class="sourceLine" id="cb35-8" title="8">  x_center[,i]&lt;-x[,i]<span class="op">-</span><span class="kw">mean</span>(x[,i])</a>
<a class="sourceLine" id="cb35-9" title="9">}</a>
<a class="sourceLine" id="cb35-10" title="10"><span class="co">## sigma_hat is the maximum likelihood estimator of covariance</span></a>
<a class="sourceLine" id="cb35-11" title="11">sigma_hat&lt;-<span class="kw">cov</span>(x)<span class="op">*</span>(r<span class="dv">-1</span>)<span class="op">/</span>r</a>
<a class="sourceLine" id="cb35-12" title="12">b0&lt;-x_center<span class="op">%*%</span><span class="kw">solve</span>(sigma_hat)<span class="op">%*%</span><span class="kw">t</span>(x_center)</a>
<a class="sourceLine" id="cb35-13" title="13">b1&lt;-<span class="kw">sum</span>(<span class="kw">colSums</span>(b0<span class="op">^</span><span class="dv">3</span>))<span class="op">/</span>(r<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-14" title="14">b&lt;-r<span class="op">*</span>b1<span class="op">/</span><span class="dv">6</span> <span class="co"># Approximately follows the Chi-square distribution</span></a>
<a class="sourceLine" id="cb35-15" title="15"><span class="kw">as.integer</span>(b<span class="op">&gt;</span>v1)<span class="co">##return 0(accept H0) or 1(reject H0)</span></a>
<a class="sourceLine" id="cb35-16" title="16">}</a></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co">#n is a vector of sample sizes</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="co">#we are doing length(n) different simulations</span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="co"># set.seed(123)</span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="co"># library(MASS)</span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="co"># p.reject&lt;-numeric(length(n))    #to store sim.results</span></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="co"># mean1&lt;-c(0,0,0)</span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="co"># sigma&lt;-matrix(c(1,0,0,0,1,0,0,0,1),nrow=3,ncol=3)</span></a>
<a class="sourceLine" id="cb36-8" title="8"><span class="co"># m&lt;-1000 </span></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="co">#  for(i in 1:length(n)) {</span></a>
<a class="sourceLine" id="cb36-10" title="10"><span class="co">#    p.reject[i]&lt;-mean(replicate(m,expr ={</span></a>
<a class="sourceLine" id="cb36-11" title="11"><span class="co">#      x&lt;-mvrnorm(n[i],mean1,sigma)</span></a>
<a class="sourceLine" id="cb36-12" title="12"><span class="co">#      sk(x)</span></a>
<a class="sourceLine" id="cb36-13" title="13"><span class="co">#    })) #proportion rejected</span></a>
<a class="sourceLine" id="cb36-14" title="14"><span class="co">#     }</span></a></code></pre></div>
<p>The results of the simulation are the empirical estimates of Type I error rate summarized below,these estimates are close to the nominal level <span class="math inline">\(\alpha=0.05\)</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co"># res&lt;-rbind(p.reject=p.reject)</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="co"># colnames(res)&lt;-paste0(n)</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="co"># kable(res,digits=getOption(&quot;digits&quot;),align =&quot;lccrr&quot;) </span></a></code></pre></div>
</div>
<div id="section-1" class="section level3">
<h3>(2)</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">alpha &lt;-.<span class="dv">1</span></a>
<a class="sourceLine" id="cb38-2" title="2">n&lt;-<span class="dv">30</span></a>
<a class="sourceLine" id="cb38-3" title="3">m&lt;-<span class="dv">2500</span></a>
<a class="sourceLine" id="cb38-4" title="4">x&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb38-5" title="5">epsilon&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">0.15</span>, <span class="fl">0.01</span>),<span class="kw">seq</span>(<span class="fl">0.15</span>, <span class="dv">1</span>, <span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb38-6" title="6">N&lt;-<span class="kw">length</span>(epsilon)</a>
<a class="sourceLine" id="cb38-7" title="7">power&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb38-8" title="8">sigma1&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="co"># set.seed(1234)</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="co"># for(j in 1:N) { #for each epsilon</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="co"># e&lt;-epsilon[j] </span><span class="al">###</span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="co"># sktest&lt;-numeric(m)</span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="co"># for(i in 1:m)</span></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="co"># {</span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="co">#   for(k in 1:n)</span></a>
<a class="sourceLine" id="cb39-9" title="9"><span class="co">#   {</span></a>
<a class="sourceLine" id="cb39-10" title="10"><span class="co">#     u&lt;-runif(1)</span></a>
<a class="sourceLine" id="cb39-11" title="11"><span class="co">#     if(u&gt;e)</span></a>
<a class="sourceLine" id="cb39-12" title="12"><span class="co">#       x[k,]&lt;-mvrnorm(1,mean1,sigma)</span></a>
<a class="sourceLine" id="cb39-13" title="13"><span class="co">#     else x[k,]&lt;-mvrnorm(1,mean1,sigma1)</span></a>
<a class="sourceLine" id="cb39-14" title="14"><span class="co">#   }</span></a>
<a class="sourceLine" id="cb39-15" title="15"><span class="co"># sktest[i]&lt;-sk(x)</span></a>
<a class="sourceLine" id="cb39-16" title="16"><span class="co"># }</span></a>
<a class="sourceLine" id="cb39-17" title="17"><span class="co"># power[j]&lt;-mean(sktest)</span></a>
<a class="sourceLine" id="cb39-18" title="18"><span class="co"># }</span></a></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="co"># plot(epsilon,power,type =&quot;b&quot;,col=&quot;blue&quot;,</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="co"># xlab =bquote(epsilon),ylim =c(0,1))</span></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="co"># abline(h =.1,lty =3)</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="co"># se&lt;-sqrt(power*(1-power)/m) #add standard errors</span></a>
<a class="sourceLine" id="cb40-6" title="6"><span class="co"># lines(epsilon,power+se,lty=3,col=&quot;red&quot;)</span></a>
<a class="sourceLine" id="cb40-7" title="7"><span class="co"># lines(epsilon,power-se,lty=3,col=&quot;green&quot;)</span></a></code></pre></div>
<p>The empirical power curve is shown in above. Note that the power curve crosses the horizontal line corresponding to <span class="math inline">\(\alpha\)</span> = 0.10 at both endpoints, for <span class="math inline">\(0&lt;\varepsilon&lt;1\)</span>, theempirical power of the test is greater than 0.10 and highest when <span class="math inline">\(\varepsilon\)</span>is about 0.2.</p>
<div id="sixth-homework" class="section level4">
<h4>sixth homework</h4>
</div>
</div>
<div id="question-7.7" class="section level3">
<h3>Question 7.7</h3>
<p>Refer to Exercise 7.6. Efron and Tibshirani discuss the following example [84, Ch. 7]. The five-dimensional scores data have a 5 * 5 covariance matrix<span class="math inline">\(\Sigma\)</span>,with positive eigenvalues <span class="math inline">\(\lambda_1&gt;......&gt;\lambda_5\)</span>. In principal components analysis<span class="math display">\[\theta=\frac{\lambda_1}{\sum_{j=1}^5\lambda_j}\]</span>. measures the proportion of variance explained by the first principal component. Let<span class="math inline">\(\hat\lambda_1&gt;......&gt;\hat\lambda_5\)</span> be the eigenvalues of <span class="math inline">\(\hat\Sigma\)</span>, where <span class="math inline">\(\hat\Sigma\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math display">\[\hat\theta=\frac{\hat\lambda_1}{\sum_{j=1}^5\hat\lambda_j}\]</span> of <span class="math inline">\(\theta\)</span>.Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="answer-10" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co">##Bootstrap</span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb41-3" title="3"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb41-4" title="4"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb41-5" title="5"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb41-6" title="6">r&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb41-7" title="7">sigma_hat1&lt;-<span class="kw">cov</span>(scor)<span class="op">*</span>(r<span class="dv">-1</span>)<span class="op">/</span>r</a>
<a class="sourceLine" id="cb41-8" title="8">theta_hat&lt;-(<span class="kw">eigen</span>(sigma_hat1)<span class="op">$</span>values[<span class="dv">1</span>])<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(sigma_hat1)<span class="op">$</span>values)</a>
<a class="sourceLine" id="cb41-9" title="9">B&lt;-<span class="dv">2000</span></a>
<a class="sourceLine" id="cb41-10" title="10"></a>
<a class="sourceLine" id="cb41-11" title="11">theta&lt;-<span class="cf">function</span>(x,i){</a>
<a class="sourceLine" id="cb41-12" title="12">data&lt;-x[i,]</a>
<a class="sourceLine" id="cb41-13" title="13">y&lt;-<span class="kw">cov</span>(data)<span class="op">*</span>(r<span class="dv">-1</span>)<span class="op">/</span>r</a>
<a class="sourceLine" id="cb41-14" title="14">theta&lt;-<span class="kw">eigen</span>(y)<span class="op">$</span>value[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(y)<span class="op">$</span>value)</a>
<a class="sourceLine" id="cb41-15" title="15"><span class="kw">return</span>(theta)</a>
<a class="sourceLine" id="cb41-16" title="16">}</a>
<a class="sourceLine" id="cb41-17" title="17">results&lt;-<span class="kw">boot</span>(<span class="dt">data=</span><span class="kw">cbind</span>(scor<span class="op">$</span>mec,scor<span class="op">$</span>vec,scor<span class="op">$</span>alg,scor<span class="op">$</span>ana,scor<span class="op">$</span>sta),<span class="dt">statistic =</span> theta,<span class="dt">R=</span>B)</a>
<a class="sourceLine" id="cb41-18" title="18">theta_b&lt;-results<span class="op">$</span>t</a>
<a class="sourceLine" id="cb41-19" title="19">res&lt;-<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dt">theta_hat=</span>theta_hat,<span class="dt">theta_hat_star=</span><span class="kw">mean</span>(theta_b),<span class="dt">boot.bias=</span><span class="kw">mean</span>(theta_b)<span class="op">-</span>theta_hat,<span class="dt">boot.se=</span><span class="kw">sd</span>(theta_b)))</a>
<a class="sourceLine" id="cb41-20" title="20"><span class="kw">kable</span>(res,<span class="dt">digits=</span><span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span><span class="st">&quot;lccrr&quot;</span>) </a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">theta_hat</th>
<th align="center">theta_hat_star</th>
<th align="center">boot.bias</th>
<th align="right">boot.se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0.619115</td>
<td align="center">0.6206233</td>
<td align="center">0.0015082</td>
<td align="right">0.0479309</td>
</tr>
</tbody>
</table>
<p>From the result we can see, we use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span> is about 0.00151 and 0.048 respectively.</p>
</div>
<div id="question-7.8" class="section level3">
<h3>Question 7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span></p>
<p>###Answer</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="co">#jackknife method</span></a>
<a class="sourceLine" id="cb42-2" title="2">theta.jack&lt;-<span class="kw">numeric</span>(r)</a>
<a class="sourceLine" id="cb42-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r){</a>
<a class="sourceLine" id="cb42-4" title="4">   data&lt;-<span class="kw">cov</span>(scor[<span class="op">-</span>i,])<span class="op">*</span>(r<span class="dv">-2</span>)<span class="op">/</span>(r<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb42-5" title="5">   theta.jack[i]&lt;-(<span class="kw">eigen</span>(data)<span class="op">$</span>values[<span class="dv">1</span>])<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(data)<span class="op">$</span>values)</a>
<a class="sourceLine" id="cb42-6" title="6">}</a>
<a class="sourceLine" id="cb42-7" title="7">res&lt;-<span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dt">theta_hat=</span>theta_hat,<span class="dt">theta_jack=</span><span class="kw">mean</span>(theta.jack),<span class="dt">jack.bias=</span><span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta_hat,<span class="dt">jack.se=</span><span class="kw">sd</span>(theta.jack)))</a>
<a class="sourceLine" id="cb42-8" title="8"><span class="kw">kable</span>(res,<span class="dt">digits=</span><span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span><span class="st">&quot;lccrr&quot;</span>) </a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">theta_hat</th>
<th align="center">theta_jack</th>
<th align="center">jack.bias</th>
<th align="right">jack.se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0.619115</td>
<td align="center">0.6191273</td>
<td align="center">1.23e-05</td>
<td align="right">0.005343</td>
</tr>
</tbody>
</table>
<p>From the result we can see, we use jackknife to estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span> is about 1.23e-05 and 0.005 respectively.</p>
</div>
<div id="question-7.9" class="section level3">
<h3>Question 7.9</h3>
<p>Refer to Exercise 7.7. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="answer-11" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co">#  m&lt;-1e2</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="co"># ci.perc&lt;-ci.bca&lt;-matrix(NA,m,2)</span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="co"># for(i in 1:m){</span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="co"># ci&lt;-boot.ci(results,type=c(&quot;perc&quot;,&quot;bca&quot;))</span></a>
<a class="sourceLine" id="cb43-5" title="5"><span class="co"># ci.perc[i,]&lt;-ci$percent[4:5]</span></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="co"># ci.bca[i,]&lt;-ci$bca[4:5] }</span></a>
<a class="sourceLine" id="cb43-7" title="7"><span class="co"># print(&quot;the 95% percentile confidence intervals for theta_hat&quot;)</span></a>
<a class="sourceLine" id="cb43-8" title="8"><span class="co"># colMeans(ci.perc)</span></a>
<a class="sourceLine" id="cb43-9" title="9"><span class="co"># print(&quot;the 95% BCa confidence intervals for theta_hat&quot;)</span></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="co"># colMeans(ci.bca)</span></a></code></pre></div>
<p>###Question 7.B</p>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness).</p>
<p>###Answer The skewness <span class="math inline">\(\sqrt{\beta_1}\)</span> of a random variable X is defined by <span class="math display">\[\sqrt{\beta_1}=\frac{E[X-\mu_x]^3}{\sigma_x^3}\]</span>. where <span class="math inline">\(\mu_x=E[X]\)</span> and <span class="math inline">\(\sigma_X^2=Var(X)\)</span>.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb44-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb44-3" title="3"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb44-4" title="4">n&lt;-<span class="fl">1e1</span></a>
<a class="sourceLine" id="cb44-5" title="5">m&lt;-<span class="fl">1e2</span></a>
<a class="sourceLine" id="cb44-6" title="6">sk&lt;-<span class="cf">function</span>(x,i) <span class="kw">mean</span>((x[i]<span class="op">-</span><span class="kw">mean</span>(x[i]))<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span><span class="kw">mean</span>((x[i]<span class="op">-</span><span class="kw">mean</span>(x[i]))<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="fl">1.5</span> </a>
<a class="sourceLine" id="cb44-7" title="7"><span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb44-8" title="8">ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb44-9" title="9">norm&lt;-basic&lt;-perc&lt;-<span class="kw">numeric</span>(<span class="dv">3</span>)</a></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co">####  normal populations  (skewness 0)</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="kw">set.seed</span>(<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb45-3" title="3">sk1&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb45-5" title="5">   x&lt;-<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb45-6" title="6"> result1&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb45-7" title="7"> ci&lt;-<span class="kw">boot.ci</span>(result1,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb45-8" title="8"> ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb45-9" title="9"> ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb45-10" title="10"> ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb45-11" title="11"> <span class="co">#ci.bca[i,]&lt;-ci$bca[4:5],&quot;bca&quot;</span></a>
<a class="sourceLine" id="cb45-12" title="12">}</a>
<a class="sourceLine" id="cb45-13" title="13"><span class="co">#empirical coverage rates for the sample skewness</span></a>
<a class="sourceLine" id="cb45-14" title="14">norm[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk1<span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk1)</a>
<a class="sourceLine" id="cb45-15" title="15">basic[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk1<span class="op">&amp;</span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk1)</a>
<a class="sourceLine" id="cb45-16" title="16">perc[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk1<span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk1)</a>
<a class="sourceLine" id="cb45-17" title="17"><span class="co">#BCa[1]&lt;-mean(ci.bca[,1]&lt;=sk1&amp; ci.bca[,2]&gt;=sk1)</span></a>
<a class="sourceLine" id="cb45-18" title="18"></a>
<a class="sourceLine" id="cb45-19" title="19"><span class="co">##the proportion of times that the confidence intervals miss on the left</span></a>
<a class="sourceLine" id="cb45-20" title="20">norm[<span class="dv">2</span>]&lt;-<span class="kw">sum</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk1)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb45-21" title="21">basic[<span class="dv">2</span>]&lt;-<span class="kw">sum</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk1)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb45-22" title="22">perc[<span class="dv">2</span>]&lt;-<span class="kw">sum</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk1)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb45-23" title="23"><span class="co">#BCa[2]&lt;-sum(ci.bca[,2]&gt;=sk1)/m</span></a>
<a class="sourceLine" id="cb45-24" title="24"></a>
<a class="sourceLine" id="cb45-25" title="25"><span class="co">##the porportion of times that the confidence intervals miss on the right</span></a>
<a class="sourceLine" id="cb45-26" title="26">norm[<span class="dv">3</span>]&lt;-<span class="kw">sum</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk1)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb45-27" title="27">basic[<span class="dv">3</span>]&lt;-<span class="kw">sum</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk1)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb45-28" title="28">perc[<span class="dv">3</span>]&lt;-<span class="kw">sum</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk1)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb45-29" title="29"><span class="co">#BCa[3]&lt;-sum(ci.bca[,2]&lt;=sk1)/m,BCa=round(BCa,3)</span></a>
<a class="sourceLine" id="cb45-30" title="30"></a>
<a class="sourceLine" id="cb45-31" title="31">res&lt;-<span class="kw">rbind</span>(<span class="dt">norm=</span><span class="kw">round</span>(norm,<span class="dv">3</span>),<span class="dt">basic=</span><span class="kw">round</span>(basic,<span class="dv">3</span>),<span class="dt">perc=</span><span class="kw">round</span>(perc,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb45-32" title="32"><span class="kw">colnames</span>(res)&lt;-<span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;coverage probabilities&quot;</span>,<span class="st">&quot;proportion_miss on the left&quot;</span>,<span class="st">&quot;porportion_miss on the right&quot;</span>))</a>
<a class="sourceLine" id="cb45-33" title="33"><span class="kw">kable</span>(res,<span class="dt">digits =</span> <span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span> <span class="st">&quot;lccrr&quot;</span>)</a></code></pre></div>
<table>
<colgroup>
<col width="6%"></col>
<col width="26%"></col>
<col width="32%"></col>
<col width="34%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">coverage probabilities</th>
<th align="center">proportion_miss on the left</th>
<th align="center">porportion_miss on the right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">norm</td>
<td align="left">0.91</td>
<td align="center">0.05</td>
<td align="center">0.04</td>
</tr>
<tr class="even">
<td align="left">basic</td>
<td align="left">0.90</td>
<td align="center">0.07</td>
<td align="center">0.03</td>
</tr>
<tr class="odd">
<td align="left">perc</td>
<td align="left">1.00</td>
<td align="center">0.00</td>
<td align="center">0.00</td>
</tr>
</tbody>
</table>
<p>For the result above, we can see the percentile percentile confidence interval is the best performer in the empirical coverage rates for the sample skewness.</p>
<p>for the <span class="math inline">\(\chi^2(5)\)</span>, the skewness is <span class="math inline">\(\frac{\Gamma(\frac{11}{2})}{\Gamma(\frac{5}{2})}\)</span></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="co">####chi-square(5) skewness is sk=gamma(11/2)/gamma(5/2)</span></a>
<a class="sourceLine" id="cb46-2" title="2"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb46-3" title="3">sk2&lt;-<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb46-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb46-5" title="5">y&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb46-6" title="6">result2&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>y,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb46-7" title="7">ci&lt;-<span class="kw">boot.ci</span>(result2,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb46-8" title="8">ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>];ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb46-9" title="9">ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>] </a>
<a class="sourceLine" id="cb46-10" title="10">}</a>
<a class="sourceLine" id="cb46-11" title="11"></a>
<a class="sourceLine" id="cb46-12" title="12"><span class="co">#empirical coverage rates for the sample skewness</span></a>
<a class="sourceLine" id="cb46-13" title="13">norm[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk2<span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk2)</a>
<a class="sourceLine" id="cb46-14" title="14">basic[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk2<span class="op">&amp;</span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk2)</a>
<a class="sourceLine" id="cb46-15" title="15">perc[<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk2<span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk2)</a>
<a class="sourceLine" id="cb46-16" title="16"></a>
<a class="sourceLine" id="cb46-17" title="17"><span class="co">##the proportion of times that the confidence intervals miss on the left</span></a>
<a class="sourceLine" id="cb46-18" title="18">norm[<span class="dv">2</span>]&lt;-<span class="kw">sum</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk2)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb46-19" title="19">basic[<span class="dv">2</span>]&lt;-<span class="kw">sum</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk2)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb46-20" title="20">perc[<span class="dv">2</span>]&lt;-<span class="kw">sum</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&gt;=</span>sk2)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb46-21" title="21"></a>
<a class="sourceLine" id="cb46-22" title="22"><span class="co">##the porportion of times that the confidence intervals miss on the right</span></a>
<a class="sourceLine" id="cb46-23" title="23">norm[<span class="dv">3</span>]&lt;-<span class="kw">sum</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk2)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb46-24" title="24">basic[<span class="dv">3</span>]&lt;-<span class="kw">sum</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk2)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb46-25" title="25">perc[<span class="dv">3</span>]&lt;-<span class="kw">sum</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&lt;=</span>sk2)<span class="op">/</span>m</a>
<a class="sourceLine" id="cb46-26" title="26"></a>
<a class="sourceLine" id="cb46-27" title="27">res&lt;-<span class="kw">rbind</span>(<span class="dt">norm=</span><span class="kw">round</span>(norm,<span class="dv">3</span>),<span class="dt">basic=</span><span class="kw">round</span>(basic,<span class="dv">3</span>),<span class="dt">perc=</span><span class="kw">round</span>(perc,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb46-28" title="28"><span class="kw">colnames</span>(res)&lt;-<span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;coverage probabilities&quot;</span>,<span class="st">&quot;proportion_miss on the left&quot;</span>,<span class="st">&quot;porportion_miss on the right&quot;</span>))</a>
<a class="sourceLine" id="cb46-29" title="29"><span class="kw">kable</span>(res,<span class="dt">digits =</span> <span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>),<span class="dt">align =</span> <span class="st">&quot;lccrr&quot;</span>)</a></code></pre></div>
<table>
<colgroup>
<col width="6%"></col>
<col width="26%"></col>
<col width="32%"></col>
<col width="34%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">coverage probabilities</th>
<th align="center">proportion_miss on the left</th>
<th align="center">porportion_miss on the right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">norm</td>
<td align="left">0.73</td>
<td align="center">0.00</td>
<td align="center">0.27</td>
</tr>
<tr class="even">
<td align="left">basic</td>
<td align="left">0.66</td>
<td align="center">0.07</td>
<td align="center">0.27</td>
</tr>
<tr class="odd">
<td align="left">perc</td>
<td align="left">0.71</td>
<td align="center">0.00</td>
<td align="center">0.29</td>
</tr>
</tbody>
</table>
<p>For the result above, we can see all the confidence interval is bad performer in the empirical coverage rates for the sample skewness.</p>
<div id="seventh-homework" class="section level4">
<h4>seventh homework</h4>
</div>
</div>
<div id="question-3" class="section level3">
<h3>Question</h3>
<p>8.2 Implement the bivariate Spearman rank correlation test for independence [255] as a permutation test. The Spearman rank correlation test statistic can be obtained from function cor with method = spearman. Compare the achieved significance level of the permutation test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-12" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co">### Spearman rank correlation test for  independence</span></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb47-3" title="3">x&lt;-<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb47-4" title="4">y&lt;-<span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb47-5" title="5">R&lt;-<span class="fl">1e3</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb47-6" title="6">z&lt;-<span class="kw">c</span>(x,y) <span class="co">#pooled sample</span></a>
<a class="sourceLine" id="cb47-7" title="7">K&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">40</span></a>
<a class="sourceLine" id="cb47-8" title="8">reps&lt;-<span class="kw">numeric</span>(R) <span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb47-9" title="9">c&lt;-<span class="kw">cor</span>(x,y,<span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>) <span class="co"># the statistic we need</span></a>
<a class="sourceLine" id="cb47-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb47-11" title="11"><span class="co">#generate indices k for the first sample</span></a>
<a class="sourceLine" id="cb47-12" title="12">k&lt;-<span class="kw">sample</span>(K,<span class="dt">size=</span><span class="dv">20</span>,<span class="dt">replace=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb47-13" title="13">x1&lt;-z[k]</a>
<a class="sourceLine" id="cb47-14" title="14">y1&lt;-z[<span class="op">-</span>k] <span class="co">#complement of x1</span></a>
<a class="sourceLine" id="cb47-15" title="15">reps[i]&lt;-<span class="kw">cor</span>(x1,y1,<span class="dt">method=</span><span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb47-16" title="16">}</a>
<a class="sourceLine" id="cb47-17" title="17"><span class="co">##significance level as follow</span></a>
<a class="sourceLine" id="cb47-18" title="18">p0&lt;-<span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(c,reps))<span class="op">&gt;=</span><span class="kw">abs</span>(c))</a>
<a class="sourceLine" id="cb47-19" title="19">p0</a></code></pre></div>
<pre><code>## [1] 0.1638362</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co">####  p-value reported by cor.test</span></a>
<a class="sourceLine" id="cb49-2" title="2">p&lt;-<span class="kw">cor.test</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a>
<a class="sourceLine" id="cb49-3" title="3">p<span class="op">$</span>p.value</a></code></pre></div>
<pre><code>## [1] 0.1642857</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co">## The histogram of replicates  is shown as follow</span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="kw">hist</span>(reps,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">freq=</span><span class="ot">FALSE</span>,<span class="dt">xlab=</span><span class="st">&quot;T(p = 0.164)&quot;</span>,</a>
<a class="sourceLine" id="cb51-3" title="3"><span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>)</a>
<a class="sourceLine" id="cb51-4" title="4"><span class="kw">points</span>(c,<span class="dv">0</span>,<span class="dt">cex=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">pch =</span><span class="dv">16</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the result we can see, the p-value 0.164 we obtianed with cor function computing is not very different from the p-value 0.164 we obtianed with the cor.test function. And both the p-value is bigger than 0.05, so under the 0.05 significance level, we think the two sample are not correlation.</p>
</div>
<div id="question-4" class="section level3">
<h3>Question</h3>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations. (1)Unequal variances and equal expectations (2)Unequal variances and unequal expectations (3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) (4)Unbalanced samples (say, 1 case versus 10 controls) (5)Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p>
</div>
<div id="answer-13" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co">### NN</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">library</span>(RANN) <span class="co"># implementing a fast algorithm</span></a>
<a class="sourceLine" id="cb52-3" title="3"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb52-4" title="4"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb52-5" title="5"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb52-6" title="6"><span class="kw">library</span>(knitr)</a></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co">### power compare</span></a>
<a class="sourceLine" id="cb53-2" title="2">m&lt;-<span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; </a>
<a class="sourceLine" id="cb53-3" title="3">R&lt;-<span class="dv">999</span>;</a>
<a class="sourceLine" id="cb53-4" title="4"><span class="co">### Tn is the kth nearest neighbor statistic</span></a>
<a class="sourceLine" id="cb53-5" title="5">Tn&lt;-<span class="cf">function</span>(z,ix,sizes,k) </a>
<a class="sourceLine" id="cb53-6" title="6">  {</a>
<a class="sourceLine" id="cb53-7" title="7">   n1&lt;-sizes[<span class="dv">1</span>]  </a>
<a class="sourceLine" id="cb53-8" title="8">   n2&lt;-sizes[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb53-9" title="9">   n&lt;-n1<span class="op">+</span>n2</a>
<a class="sourceLine" id="cb53-10" title="10">   <span class="cf">if</span>(<span class="kw">is.vector</span>(z))z&lt;-<span class="kw">data.frame</span>(z)</a>
<a class="sourceLine" id="cb53-11" title="11">   z&lt;-z[ix,]</a>
<a class="sourceLine" id="cb53-12" title="12">   NN&lt;-<span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </a>
<a class="sourceLine" id="cb53-13" title="13">   block1&lt;-NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb53-14" title="14">   block2&lt;-NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb53-15" title="15">   i1&lt;-<span class="kw">sum</span>(block1<span class="op">&lt;=</span>n1)</a>
<a class="sourceLine" id="cb53-16" title="16">   i2&lt;-<span class="kw">sum</span>(block2<span class="op">&gt;</span>n1)</a>
<a class="sourceLine" id="cb53-17" title="17">   (i1<span class="op">+</span>i2)<span class="op">/</span>(k<span class="op">*</span>n)</a>
<a class="sourceLine" id="cb53-18" title="18">  }</a>
<a class="sourceLine" id="cb53-19" title="19"></a>
<a class="sourceLine" id="cb53-20" title="20"><span class="co">### we can obtain the p-value of NN test from the eqdist.nn</span></a>
<a class="sourceLine" id="cb53-21" title="21">eqdist.nn&lt;-<span class="cf">function</span>(z,sizes,k)</a>
<a class="sourceLine" id="cb53-22" title="22">  {</a>
<a class="sourceLine" id="cb53-23" title="23">   boot.obj&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">sizes=</span>sizes,<span class="dt">k=</span>k)</a>
<a class="sourceLine" id="cb53-24" title="24">   ts&lt;-<span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb53-25" title="25">   p.value&lt;-<span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb53-26" title="26">   <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</a>
<a class="sourceLine" id="cb53-27" title="27"> }</a>
<a class="sourceLine" id="cb53-28" title="28"></a>
<a class="sourceLine" id="cb53-29" title="29"><span class="co">### we compute the NN, energy, and ball&#39;s power when the random varible are normal</span></a>
<a class="sourceLine" id="cb53-30" title="30">power_compare&lt;-<span class="cf">function</span>(n1,n2,mu1,mu2,sigma1,sigma2){</a>
<a class="sourceLine" id="cb53-31" title="31">   p_values&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb53-32" title="32">   N&lt;-<span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb53-33" title="33">   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</a>
<a class="sourceLine" id="cb53-34" title="34">  {</a>
<a class="sourceLine" id="cb53-35" title="35">    x&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p,mu1,sigma1),<span class="dt">ncol=</span>p)</a>
<a class="sourceLine" id="cb53-36" title="36">    y&lt;-<span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,mu2,sigma2),<span class="dt">ncol=</span>p)</a>
<a class="sourceLine" id="cb53-37" title="37">    z&lt;-<span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb53-38" title="38">    p_values[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb53-39" title="39">    p_values[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb53-40" title="40">    p_values[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb53-41" title="41">  }</a>
<a class="sourceLine" id="cb53-42" title="42">  alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb53-43" title="43">  pow&lt;-<span class="kw">colMeans</span>(p_values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb53-44" title="44">  pow <span class="co">##the power vector</span></a>
<a class="sourceLine" id="cb53-45" title="45">}</a>
<a class="sourceLine" id="cb53-46" title="46"><span class="co">#we compute the NN, energy, and ball&#39;s power when the random varible are normal and student.</span></a>
<a class="sourceLine" id="cb53-47" title="47">power_compare1&lt;-<span class="cf">function</span>(n1,n2){</a>
<a class="sourceLine" id="cb53-48" title="48">   p_values&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb53-49" title="49">   N&lt;-<span class="kw">c</span>(n1,n2)</a>
<a class="sourceLine" id="cb53-50" title="50">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</a>
<a class="sourceLine" id="cb53-51" title="51">  {</a>
<a class="sourceLine" id="cb53-52" title="52">    x&lt;-<span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dv">1</span>),<span class="dt">ncol=</span>p);</a>
<a class="sourceLine" id="cb53-53" title="53">    y&lt;-<span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb53-54" title="54">    z&lt;-<span class="kw">rbind</span>(x,y)</a>
<a class="sourceLine" id="cb53-55" title="55">    p_values[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb53-56" title="56">    p_values[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb53-57" title="57">    p_values[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb53-58" title="58">  }</a>
<a class="sourceLine" id="cb53-59" title="59">  alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb53-60" title="60">  pow&lt;-<span class="kw">colMeans</span>(p_values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb53-61" title="61">  pow <span class="co">##the power vector</span></a>
<a class="sourceLine" id="cb53-62" title="62">}</a></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co">## we use vector pow1,2,3,4 denote the power of three test under four cases</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="co">## In the following four cases, n1 and n2 were uniformly used to record the sample size of two samples, mu1 and mu2 were used to record the mean values of two normal samples, and sigma1 and sigma2 were used to record the standard deviations of two normal samples.</span></a>
<a class="sourceLine" id="cb54-3" title="3"></a>
<a class="sourceLine" id="cb54-4" title="4"><span class="co"># pow1&lt;-pow2&lt;-pow3&lt;-pow4&lt;-numeric(3)  </span></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="co"># </span><span class="al">###</span><span class="co">(1)Unequal variances and equal expectations</span></a>
<a class="sourceLine" id="cb54-6" title="6"><span class="co"># set.seed(12345)</span></a>
<a class="sourceLine" id="cb54-7" title="7"><span class="co"># n1&lt;-n2&lt;-50; mu1&lt;-mu2&lt;-0; sigma1&lt;-0.1; sigma2&lt;-0.17;</span></a>
<a class="sourceLine" id="cb54-8" title="8"><span class="co"># pow1&lt;-power_compare(n1,n2,mu1,mu2,sigma1,sigma2)</span></a>
<a class="sourceLine" id="cb54-9" title="9"><span class="co"># </span></a>
<a class="sourceLine" id="cb54-10" title="10"><span class="co"># </span><span class="al">###</span><span class="co">(2)Unequal variances and unequal expectations</span></a>
<a class="sourceLine" id="cb54-11" title="11"><span class="co"># n1&lt;-n2&lt;-50; mu1&lt;-0.15; mu2&lt;-0.1; sigma1&lt;-0.11; sigma2&lt;-0.12</span></a>
<a class="sourceLine" id="cb54-12" title="12"><span class="co"># pow2&lt;-power_compare(n1,n2,mu1,mu2,sigma1,sigma2)</span></a>
<a class="sourceLine" id="cb54-13" title="13"><span class="co"># </span></a>
<a class="sourceLine" id="cb54-14" title="14"><span class="co"># </span><span class="al">###</span><span class="co">(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</span></a>
<a class="sourceLine" id="cb54-15" title="15"><span class="co"># n1&lt;-n2&lt;-30 ;</span></a>
<a class="sourceLine" id="cb54-16" title="16"><span class="co"># pow3&lt;-power_compare1(n1,n2)</span></a>
<a class="sourceLine" id="cb54-17" title="17"><span class="co"># </span></a>
<a class="sourceLine" id="cb54-18" title="18"><span class="co"># </span><span class="al">###</span><span class="co">(4)Unbalanced samples (say, 1 case versus 10 controls)</span></a>
<a class="sourceLine" id="cb54-19" title="19"><span class="co"># n1&lt;-10; n2&lt;-100 ; mu1&lt;-mu2&lt;-0; sigma1&lt;-1; sigma2&lt;-3</span></a>
<a class="sourceLine" id="cb54-20" title="20"><span class="co"># pow4&lt;-power_compare(n1,n2,mu1,mu2,sigma1,sigma2)</span></a>
<a class="sourceLine" id="cb54-21" title="21"><span class="co"># </span></a>
<a class="sourceLine" id="cb54-22" title="22"><span class="co"># res&lt;-rbind(pow1=round(pow1,4),pow2=round(pow2,4),pow3=round(pow3,4),pow4=round(pow4,4))</span></a>
<a class="sourceLine" id="cb54-23" title="23"><span class="co"># colnames(res)&lt;-paste0(c(&quot;NN&quot;,&quot;energy&quot;,&quot;Ball&quot;))</span></a>
<a class="sourceLine" id="cb54-24" title="24"><span class="co"># kable(res,digits = getOption(&quot;digits&quot;),align = &quot;lccrr&quot;)</span></a></code></pre></div>
<p>As can be seen from the above table, the power of the three tests are different in different cases, and none of them is the best. However, it can be seen that the power of test Ball is relatively stable, and in many cases, its power is relatively large.</p>
<div id="eighth-homework" class="section level4">
<h4>eighth homework</h4>
</div>
</div>
<div id="question-9.3" class="section level3">
<h3>Question 9.3</h3>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy(<span class="math inline">\(\theta\)</span>,<span class="math inline">\(\eta\)</span>) distribution has density function<span class="math display">\[f(x)={\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)}},-\infty&lt;x&lt;\infty,\theta&gt;0.\]</span> The standard Cauchy has the Cauchy(<span class="math inline">\(\theta\)</span>=1, <span class="math inline">\(\eta\)</span>= 0) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
</div>
<div id="answer-14" class="section level3">
<h3>Answer</h3>
<p>we choose normal distribution as the proposal distribution.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">set.seed</span>(<span class="dv">23466</span>)</a>
<a class="sourceLine" id="cb55-3" title="3"><span class="co">#####</span></a>
<a class="sourceLine" id="cb55-4" title="4">y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb55-5" title="5"><span class="co">#####</span></a>
<a class="sourceLine" id="cb55-6" title="6">m&lt;-<span class="fl">1e2</span></a>
<a class="sourceLine" id="cb55-7" title="7">x&lt;-<span class="kw">numeric</span>(m)   <span class="co">### Markov chains</span></a>
<a class="sourceLine" id="cb55-8" title="8">x[<span class="dv">1</span>]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb55-9" title="9">k&lt;-<span class="dv">0</span>  <span class="co">#### The chain length</span></a>
<a class="sourceLine" id="cb55-10" title="10">u&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb55-11" title="11"> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb55-12" title="12">            y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb55-13" title="13">                <span class="cf">if</span>(u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dt</span>(y,<span class="dv">1</span>)<span class="op">/</span><span class="kw">dt</span>(x[i<span class="dv">-1</span>],<span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb55-14" title="14">                    x[i] &lt;-<span class="st"> </span>y  </a>
<a class="sourceLine" id="cb55-15" title="15">                <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb55-16" title="16">                    x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb55-17" title="17">                    k &lt;-k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb55-18" title="18">                } }</a>
<a class="sourceLine" id="cb55-19" title="19">index&lt;-<span class="dv">11</span><span class="op">:</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb55-20" title="20">    y1&lt;-x[index]</a>
<a class="sourceLine" id="cb55-21" title="21">Q_sample&lt;-<span class="kw">quantile</span>(y1,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb55-22" title="22">a&lt;-<span class="kw">ppoints</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb55-23" title="23">Q_Cauchy&lt;-<span class="kw">qt</span>(<span class="fl">0.1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb55-24" title="24">Quantile&lt;-<span class="kw">data.frame</span>(<span class="dt">sample_quantile=</span>Q_sample,<span class="dt">Cauchy_quantile=</span>Q_Cauchy)</a>
<a class="sourceLine" id="cb55-25" title="25">  <span class="kw">kable</span>(Quantile)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">sample_quantile</th>
<th align="right">Cauchy_quantile</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">10%</td>
<td align="right">-0.7191548</td>
<td align="right">-3.077684</td>
</tr>
</tbody>
</table>
<p>Discard the first 1000 of the chain,the deciles of the generated observations is less than the deciles of the standard Cauchy distribution,they are is -2.461,-3.078 respective.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">a&lt;-<span class="kw">ppoints</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb56-2" title="2">Q_Cauchy1&lt;-<span class="kw">qt</span>(a,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb56-3" title="3">Q_sample1&lt;-<span class="kw">quantile</span>(y1,a)</a>
<a class="sourceLine" id="cb56-4" title="4"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb56-5" title="5">    <span class="kw">qqplot</span>(Q_Cauchy1,Q_sample1, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb56-6" title="6">        <span class="dt">xlab=</span><span class="st">&quot;Cauchy Quantiles&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</a>
<a class="sourceLine" id="cb56-7" title="7">    <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;blue&#39;</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb56-8" title="8">    <span class="kw">hist</span>(y1, <span class="dt">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>),<span class="dt">freq=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb56-9" title="9">    <span class="kw">lines</span>(Q_Cauchy1,<span class="kw">dt</span>(Q_Cauchy1,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The QQ plot is an informal approach to assessing the goodness-of-fit of the generated sample with the target distribution. From the plot, it appears that the sample quantiles are in approximate agreement with the theoretical quantiles.</p>
</div>
<div id="question-9.8" class="section level3">
<h3>Question 9.8</h3>
<p>This example appears in [40]. Consider the bivariate density.<span class="math display">\[f(x,y)\varpropto\left(\begin{array}{1}
 n\\x\end{array}\right)y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,...,n,0\leq{y}\leq{1}.\]</span> It can be shown (see e.g.[23]) that for fixed a, b, n, the conditional distributions are Binomial(n,y) and Beta(x+a,n-x+b). Use the Gibbs sampler to generate a chain with target joint density f(x,y).</p>
</div>
<div id="answer-15" class="section level3">
<h3>Answer</h3>
<p><span class="math display">\[(X|Y)\sim Binomial(n,y)\]</span> <span class="math display">\[(Y|X)\sim Beta(x+a,n-x+b).\]</span></p>
<p>we consider the case for a=2,b=3,n=100.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co">#initialize constants and parameters</span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">set.seed</span>(<span class="dv">11093</span>)</a>
<a class="sourceLine" id="cb57-3" title="3">N&lt;-<span class="dv">5000</span> <span class="co">#length of chain</span></a>
<a class="sourceLine" id="cb57-4" title="4">burn&lt;-<span class="dv">1000</span> <span class="co">#burn-in length</span></a>
<a class="sourceLine" id="cb57-5" title="5">X&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></a>
<a class="sourceLine" id="cb57-6" title="6">a&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb57-7" title="7">b&lt;-<span class="dv">3</span></a>
<a class="sourceLine" id="cb57-8" title="8">n&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb57-9" title="9"><span class="co">###### generate the chain #####</span></a>
<a class="sourceLine" id="cb57-10" title="10">X[<span class="dv">1</span>,]&lt;-<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.1</span>) <span class="co">#initialize</span></a>
<a class="sourceLine" id="cb57-11" title="11"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb57-12" title="12">y&lt;-X[i<span class="dv">-1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb57-13" title="13">X[i,<span class="dv">1</span>]&lt;-<span class="kw">rbinom</span>(<span class="dv">1</span>,n,y)</a>
<a class="sourceLine" id="cb57-14" title="14">x&lt;-X[i,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb57-15" title="15">X[i,<span class="dv">2</span>]&lt;-<span class="kw">rbeta</span>(<span class="dv">1</span>,x<span class="op">+</span>a,n<span class="op">-</span>x<span class="op">+</span>b)</a>
<a class="sourceLine" id="cb57-16" title="16">}</a>
<a class="sourceLine" id="cb57-17" title="17">b&lt;-burn<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb57-18" title="18">M&lt;-X[b<span class="op">:</span>N,]</a>
<a class="sourceLine" id="cb57-19" title="19"><span class="co"># compare sample statistics to parameters</span></a>
<a class="sourceLine" id="cb57-20" title="20"><span class="kw">colMeans</span>(M)</a></code></pre></div>
<pre><code>## [1] 37.7045000  0.3777616</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">plot</span>(M, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="kw">bquote</span>(X),<span class="dt">ylab=</span><span class="kw">bquote</span>(Y), <span class="dt">ylim=</span><span class="kw">range</span>(M[,<span class="dv">2</span>]))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>bivariate chain generated by the Gibbs sampler plot in above.</p>
</div>
<div id="question-5" class="section level3">
<h3>Question</h3>
<p>For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-16" class="section level3">
<h3>Answer</h3>
<ol style="list-style-type: decimal">
<li>Gelman-Rubin method to monitor convergence of the chain in 9.3</li>
</ol>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</a>
<a class="sourceLine" id="cb60-2" title="2">                                <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></a>
<a class="sourceLine" id="cb60-3" title="3">                               <span class="co"># for chain in i-th row of X</span></a>
<a class="sourceLine" id="cb60-4" title="4">    psi&lt;-<span class="kw">as.matrix</span>(psi)</a>
<a class="sourceLine" id="cb60-5" title="5">    n&lt;-<span class="kw">ncol</span>(psi)</a>
<a class="sourceLine" id="cb60-6" title="6">    k&lt;-<span class="kw">nrow</span>(psi)</a>
<a class="sourceLine" id="cb60-7" title="7">    psi.means&lt;-<span class="kw">rowMeans</span>(psi)    <span class="co">#row means</span></a>
<a class="sourceLine" id="cb60-8" title="8">    B&lt;-n<span class="op">*</span><span class="kw">var</span>(psi.means)         <span class="co">#between variance est.</span></a>
<a class="sourceLine" id="cb60-9" title="9">    psi.w&lt;-<span class="kw">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)   <span class="co">#within variances</span></a>
<a class="sourceLine" id="cb60-10" title="10">    W&lt;-<span class="kw">mean</span>(psi.w)              <span class="co">#within est.</span></a>
<a class="sourceLine" id="cb60-11" title="11">    v.hat&lt;-W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">+</span>(B<span class="op">/</span>n)      <span class="co">#upper variance est.</span></a>
<a class="sourceLine" id="cb60-12" title="12">    r.hat&lt;-v.hat<span class="op">/</span>W              <span class="co">#G-R statistic</span></a>
<a class="sourceLine" id="cb60-13" title="13">    <span class="kw">return</span>(r.hat)</a>
<a class="sourceLine" id="cb60-14" title="14">}</a></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">Cauchy.chain &lt;-<span class="st"> </span><span class="cf">function</span>(N,X1) </a>
<a class="sourceLine" id="cb61-2" title="2">  {</a>
<a class="sourceLine" id="cb61-3" title="3"> <span class="co">#with Normal(X[t], 5) proposal distribution</span></a>
<a class="sourceLine" id="cb61-4" title="4"> <span class="co">#and starting value X1</span></a>
<a class="sourceLine" id="cb61-5" title="5">    x&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb61-6" title="6">    x[<span class="dv">1</span>]&lt;-X1</a>
<a class="sourceLine" id="cb61-7" title="7">    u&lt;-<span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb61-8" title="8"> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">1000</span>) {</a>
<a class="sourceLine" id="cb61-9" title="9">            y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb61-10" title="10">                <span class="cf">if</span> (u[i]<span class="op">&lt;=</span>(<span class="kw">dt</span>(y,<span class="dv">1</span>)<span class="op">/</span><span class="kw">dt</span>(x[i<span class="dv">-1</span>],<span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb61-11" title="11">                    x[i] &lt;-y  </a>
<a class="sourceLine" id="cb61-12" title="12">                <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb61-13" title="13">                    x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb61-14" title="14">                    k&lt;-k<span class="op">+</span><span class="dv">1</span> } }</a>
<a class="sourceLine" id="cb61-15" title="15">    <span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb61-16" title="16">}</a></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">k&lt;-<span class="dv">4</span> <span class="co">#number of chains to generate</span></a>
<a class="sourceLine" id="cb62-2" title="2">n&lt;-<span class="dv">2000</span> <span class="co">#length of chains</span></a>
<a class="sourceLine" id="cb62-3" title="3">bu&lt;-<span class="dv">500</span> <span class="co">#burn-in length</span></a>
<a class="sourceLine" id="cb62-4" title="4"><span class="co">#choose overdispersed initial values</span></a>
<a class="sourceLine" id="cb62-5" title="5">x0&lt;-<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">-1</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb62-6" title="6"><span class="co">#generate the chains</span></a>
<a class="sourceLine" id="cb62-7" title="7"><span class="kw">set.seed</span>(<span class="dv">123455</span>)</a>
<a class="sourceLine" id="cb62-8" title="8">X&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</a>
<a class="sourceLine" id="cb62-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb62-10" title="10">X[i,]&lt;-<span class="kw">Cauchy.chain</span>(n, x0[i])</a>
<a class="sourceLine" id="cb62-11" title="11"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb62-12" title="12">psi&lt;-<span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb62-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</a>
<a class="sourceLine" id="cb62-14" title="14">psi[i,]&lt;-psi[i,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb62-15" title="15"><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</a></code></pre></div>
<pre><code>## [1] 1.107312</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="co">#plot psi for the four chains</span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="co"># par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb64-3" title="3"><span class="co"># for (i in 1:k)</span></a>
<a class="sourceLine" id="cb64-4" title="4"><span class="co"># plot(psi[i,(bu+1):n], type=&quot;l&quot;,</span></a>
<a class="sourceLine" id="cb64-5" title="5"><span class="co"># xlab=i, ylab=bquote(psi))</span></a>
<a class="sourceLine" id="cb64-6" title="6"></a>
<a class="sourceLine" id="cb64-7" title="7">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</a>
<a class="sourceLine" id="cb64-8" title="8"><span class="cf">for</span>(j <span class="cf">in</span> (bu<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</a>
<a class="sourceLine" id="cb64-9" title="9">rhat[j]&lt;-<span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb64-10" title="10"><span class="kw">plot</span>(rhat[(bu<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</a>
<a class="sourceLine" id="cb64-11" title="11"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plots of the four sequences of the summary statistic (the mean) <span class="math inline">\(\psi\)</span> are shown in above from time 5001 to 20000. Rather than interpret the plots, The plot of <span class="math inline">\(\hat{R}\)</span> over time 5001 to 20000 suggests that the chain has approximately converged to the target distribution within approximately 12000 iterations.</p>
<ol start="2" style="list-style-type: decimal">
<li>Gelman-Rubin method to monitor convergence of the chain in 9.8</li>
</ol>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">k&lt;-<span class="dv">4</span> <span class="co">#number of chains to generate</span></a>
<a class="sourceLine" id="cb65-2" title="2">N&lt;-<span class="dv">1500</span> <span class="co">#length of chains</span></a>
<a class="sourceLine" id="cb65-3" title="3">bu&lt;-<span class="dv">500</span> <span class="co">#burn-in length</span></a>
<a class="sourceLine" id="cb65-4" title="4"><span class="co">#generate the chains</span></a>
<a class="sourceLine" id="cb65-5" title="5">MC.chain&lt;-<span class="cf">function</span>(N,x0){</a>
<a class="sourceLine" id="cb65-6" title="6">X&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></a>
<a class="sourceLine" id="cb65-7" title="7">a&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb65-8" title="8">b&lt;-<span class="dv">3</span></a>
<a class="sourceLine" id="cb65-9" title="9">n&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb65-10" title="10"><span class="co">###### generate the chain #####</span></a>
<a class="sourceLine" id="cb65-11" title="11">X[<span class="dv">1</span>,]&lt;-x0 <span class="co">#initialize</span></a>
<a class="sourceLine" id="cb65-12" title="12"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb65-13" title="13">y&lt;-X[i<span class="dv">-1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb65-14" title="14">X[i,<span class="dv">1</span>]&lt;-<span class="kw">rbinom</span>(<span class="dv">1</span>,n,y)</a>
<a class="sourceLine" id="cb65-15" title="15">x&lt;-X[i,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb65-16" title="16">X[i,<span class="dv">2</span>]&lt;-<span class="kw">rbeta</span>(<span class="dv">1</span>,x<span class="op">+</span>a,n<span class="op">-</span>x<span class="op">+</span>b)</a>
<a class="sourceLine" id="cb65-17" title="17">}</a>
<a class="sourceLine" id="cb65-18" title="18"><span class="kw">return</span>(X)</a>
<a class="sourceLine" id="cb65-19" title="19">}</a></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb66-2" title="2">x0&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">5</span>,<span class="fl">0.5</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb66-3" title="3">X1&lt;-<span class="kw">MC.chain</span>(N,x0[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb66-4" title="4"><span class="co">#X1</span></a>
<a class="sourceLine" id="cb66-5" title="5">X2&lt;-<span class="kw">MC.chain</span>(N,x0[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb66-6" title="6">Y&lt;-<span class="kw">cbind</span>(X1,X2)</a>
<a class="sourceLine" id="cb66-7" title="7"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb66-8" title="8">psi1&lt;-<span class="kw">apply</span>(Y, <span class="dv">1</span>, cumsum)</a>
<a class="sourceLine" id="cb66-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi1))</a>
<a class="sourceLine" id="cb66-10" title="10">psi1[i,]&lt;-psi1[i,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi1))</a>
<a class="sourceLine" id="cb66-11" title="11"><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi1))</a></code></pre></div>
<pre><code>## [1] 1.011864</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="co">#plot psi for the four chains</span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="co"># par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="co"># for (i in 1:4)</span></a>
<a class="sourceLine" id="cb68-4" title="4"><span class="co"># plot(psi1[i,(bu+1):N], type=&quot;l&quot;,</span></a>
<a class="sourceLine" id="cb68-5" title="5"><span class="co"># xlab=i)</span></a>
<a class="sourceLine" id="cb68-6" title="6"><span class="co"># par(mfrow=c(1,1)) #restore default</span></a>
<a class="sourceLine" id="cb68-7" title="7"><span class="co">#plot the sequence of R-hat statistics</span></a>
<a class="sourceLine" id="cb68-8" title="8">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</a>
<a class="sourceLine" id="cb68-9" title="9"><span class="cf">for</span>(j <span class="cf">in</span> (bu<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</a>
<a class="sourceLine" id="cb68-10" title="10"> rhat[j]&lt;-<span class="kw">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb68-11" title="11"><span class="kw">plot</span>(rhat[(bu<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</a>
<a class="sourceLine" id="cb68-12" title="12"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb68-13" title="13"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.1</span>, <span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plots of the two sequences of bivariate for the summary statistic (the mean) <span class="math inline">\(\psi\)</span> are shown in above from time 5001 to 20000. Rather than interpret the plots,The plot of <span class="math inline">\(\hat{R}\)</span> over time 5001 to 20000 suggests that the chain has approximately converged to the target distribution within approximately less than 5000 iterations.</p>
<div id="nineth-homework" class="section level4">
<h4>nineth homework</h4>
</div>
</div>
<div id="question-11.3" class="section level3">
<h3>Question 11.3</h3>
<ol style="list-style-type: lower-alpha">
<li>Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in<span class="math display">\[\sum_{k=0}^{\infty}\frac{(-1)^k{\|a\|}^{2k+2}\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{k!2^k(2k+1)(2k+2)\Gamma(k+\frac{d}{2}+1)}\]</span>, where <span class="math inline">\(d\geq1\)</span> is an integer,a is a vector in <span class="math inline">\(R^d\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm. Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large k and d.(This sum converges for all <span class="math inline">\(a\in{R^d}\)</span>).</li>
<li>Modify the function so that it computes and returns the sum. (c)Evaluate the sum when <span class="math inline">\(a=(1,2)^T\)</span>.</li>
</ol>
</div>
<div id="answer-17" class="section level3">
<h3>Answer</h3>
<p>The function as follow</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co">##(a)</span></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="co">### the kth term,k!=gamma(k+1)</span></a>
<a class="sourceLine" id="cb69-3" title="3">f&lt;-<span class="cf">function</span>(k,a,d)</a>
<a class="sourceLine" id="cb69-4" title="4">  {(<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>k<span class="op">*</span><span class="kw">exp</span>(((<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(<span class="kw">norm</span>(a,<span class="dt">type=</span><span class="st">&quot;F&quot;</span>))<span class="op">+</span><span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">-</span>k<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span>)<span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>)) )</a>
<a class="sourceLine" id="cb69-5" title="5">}</a>
<a class="sourceLine" id="cb69-6" title="6">k&lt;-<span class="dv">8</span></a>
<a class="sourceLine" id="cb69-7" title="7">d&lt;-<span class="dv">3</span></a>
<a class="sourceLine" id="cb69-8" title="8">a&lt;-<span class="kw">as.matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb69-9" title="9"><span class="kw">f</span>(k,a,d)</a></code></pre></div>
<pre><code>## [1] 0.6885679</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co">###(b)</span></a>
<a class="sourceLine" id="cb71-2" title="2"><span class="co"># K&lt;-0:1e5</span></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="co"># sum(f(k,a,d))</span></a>
<a class="sourceLine" id="cb71-4" title="4">summ&lt;-<span class="cf">function</span>(a,d)</a>
<a class="sourceLine" id="cb71-5" title="5">{</a>
<a class="sourceLine" id="cb71-6" title="6">  k=<span class="dv">0</span></a>
<a class="sourceLine" id="cb71-7" title="7">  x&lt;-y&lt;-<span class="kw">f</span>(k,a,d)</a>
<a class="sourceLine" id="cb71-8" title="8">  <span class="cf">while</span>(x<span class="op">&gt;</span><span class="fl">1e-5</span>){</a>
<a class="sourceLine" id="cb71-9" title="9">   k=k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb71-10" title="10">   x&lt;-<span class="kw">f</span>(k,a,d)</a>
<a class="sourceLine" id="cb71-11" title="11">   y&lt;-y<span class="op">+</span>x</a>
<a class="sourceLine" id="cb71-12" title="12">  }</a>
<a class="sourceLine" id="cb71-13" title="13">  y</a>
<a class="sourceLine" id="cb71-14" title="14">}</a></code></pre></div>
<p>The sum as follow</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co">### (c)</span></a>
<a class="sourceLine" id="cb72-2" title="2">a&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb72-3" title="3">d&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb72-4" title="4"><span class="kw">summ</span>(a,d)</a></code></pre></div>
<pre><code>## [1] 1.349903</code></pre>
</div>
<div id="quetion-11.5" class="section level3">
<h3>Quetion 11.5</h3>
<p>Write a function to solve the equation<span class="math display">\[\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}du\]</span> <span class="math display">\[=\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi{k}}\Gamma(\frac{k}{2})}\int_0^{c_{k}}(1+\frac{u^2}{k})^{-(k+1)/2}du\]</span>, for a, where <span class="math display">\[c_k=\sqrt{\frac{a^2k}{k+1-a^2}}\]</span>. Compare the solutions with the points A(k) in Exercise 11.4.</p>
</div>
<div id="answer-18" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb74-2" title="2">s&lt;-<span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb74-3" title="3">  <span class="kw">return</span>(<span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k,<span class="dt">lower.tail =</span> F))</a>
<a class="sourceLine" id="cb74-4" title="4">}</a>
<a class="sourceLine" id="cb74-5" title="5">delta.s &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb74-6" title="6">  <span class="kw">s</span>(k,a)<span class="op">-</span><span class="kw">s</span>(k<span class="dv">-1</span>,a)</a>
<a class="sourceLine" id="cb74-7" title="7">}</a>
<a class="sourceLine" id="cb74-8" title="8">n&lt;-<span class="kw">length</span>(k)</a>
<a class="sourceLine" id="cb74-9" title="9">A&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb74-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb74-11" title="11">  A[i]&lt;-<span class="kw">uniroot</span>(delta.s,<span class="dt">interval=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dt">k=</span>k[i])<span class="op">$</span>root</a>
<a class="sourceLine" id="cb74-12" title="12">}</a>
<a class="sourceLine" id="cb74-13" title="13">result&lt;-<span class="kw">cbind</span>(k,A)</a>
<a class="sourceLine" id="cb74-14" title="14">knitr<span class="op">::</span><span class="kw">kable</span>(result)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">A</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">1.492103</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.533556</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.562744</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584430</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601185</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.614521</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625390</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634419</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642038</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.648554</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654190</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659114</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663452</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667304</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.670745</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.673840</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.676637</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679178</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681496</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">1.683620</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">1.685572</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">1.687373</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.720608</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">1.729756</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.730908</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="co">#11.5</span></a>
<a class="sourceLine" id="cb75-2" title="2">f1&lt;-<span class="cf">function</span>(u)(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb75-3" title="3">f2&lt;-<span class="cf">function</span>(u)(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k))<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb75-4" title="4">m&lt;-<span class="cf">function</span>(k)<span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">2</span>)<span class="op">+</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>(<span class="kw">log</span>(pi)<span class="op">+</span><span class="kw">log</span>(k<span class="dv">-1</span>))<span class="op">-</span><span class="kw">lgamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb75-5" title="5">fu&lt;-<span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb75-6" title="6">  f&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb75-7" title="7">  <span class="kw">m</span>(k)<span class="op">*</span><span class="kw">integrate</span>(f1,<span class="dt">lower=</span><span class="dv">0</span>,<span class="dt">upper=</span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>)<span class="op">$</span>value<span class="op">-</span><span class="kw">m</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">integrate</span>(f2,<span class="dt">lower=</span><span class="dv">0</span>,<span class="dt">upper=</span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb75-8" title="8">}</a>
<a class="sourceLine" id="cb75-9" title="9"><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="op">-</span><span class="fl">1e-7</span>,<span class="fl">1.99</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb75-10" title="10">}</a>
<a class="sourceLine" id="cb75-11" title="11">res&lt;-<span class="kw">numeric</span>(<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb75-12" title="12"><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">4</span><span class="op">:</span><span class="dv">25</span>)</a>
<a class="sourceLine" id="cb75-13" title="13">  res[k<span class="dv">-3</span>]&lt;-<span class="kw">fu</span>(k)</a></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">f&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb76-2" title="2">  <span class="kw">m</span>(k)<span class="op">*</span><span class="kw">integrate</span>(f1,<span class="dt">lower=</span><span class="dv">0</span>,<span class="dt">upper=</span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>)<span class="op">$</span>value<span class="op">-</span><span class="kw">m</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">integrate</span>(f2,<span class="dt">lower=</span><span class="dv">0</span>,<span class="dt">upper=</span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb76-3" title="3">}</a>
<a class="sourceLine" id="cb76-4" title="4">k&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb76-5" title="5">res[<span class="dv">23</span>]&lt;-<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="op">-</span><span class="fl">1e-7</span>,<span class="fl">1.99</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb76-6" title="6">k&lt;-<span class="dv">500</span></a>
<a class="sourceLine" id="cb76-7" title="7">res[<span class="dv">24</span>]&lt;-<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="op">-</span><span class="fl">1e-7</span>,<span class="fl">1.99</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb76-8" title="8">k&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb76-9" title="9">res[<span class="dv">25</span>]&lt;-<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="op">-</span><span class="fl">1e-7</span>,<span class="fl">1.99</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb76-10" title="10">res</a></code></pre></div>
<pre><code>##  [1] 1.492102 1.533558 1.562723 1.584430 1.601184 1.614520 1.625388 1.634416
##  [9] 1.642035 1.648550 1.654186 1.659110 1.663448 1.667299 1.670740 1.673835
## [17] 1.676632 1.679172 1.681490 1.683614 1.685566 1.687367 1.720607 1.729754
## [25] 1.730906</code></pre>
<p>Compare the solutions with the points A(k) in Exercise 11.4, we know A(K) is 0 or not exist,but in this case, the root of equation is bigger than 0, they are in (1.3,1.8).</p>
</div>
<div id="question-6" class="section level3">
<h3>Question</h3>
<p>Suppose <span class="math inline">\(T_1,...,T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i=T_iI(T_i\leq{\tau})+\tau{I(T_i&gt;\tau)},i=1,...,n\)</span>. Suppose <span class="math inline">\(\tau\)</span>= 1 and the observed <span class="math inline">\(T_i\)</span> values are as follows: 0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85 Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
</div>
<div id="answer-19" class="section level3">
<h3>Answer</h3>
<ul>
<li>EM observed data: <span class="math inline">\(T_1,T_2,...,T_r,1,...,1,T_i\)</span> is less than 1,the sample size is denote n, complete data: <span class="math inline">\(T_1,...,T_n\)</span>
<ul>
<li>Observed data likelihood <span class="math display">\[L(\lambda|T_1,T_2,...,T_r,1,...,1)=\prod_{i=1}^r(\frac{1}{\lambda}e^{-\frac{T_i}{\lambda}})(e^{-\frac{1}{\lambda}})^{n-r}\]</span> <span class="math display">\[\lambda_{MLE}=\frac{\sum_{i=1}^r+n-r}{r}=\frac{6.75}{7}=0.964285\]</span></li>
<li>Complete data likelihood <span class="math display">\[L(\lambda|T_1,T_2,...,T_n)=\prod_{i=1}^n(\frac{1}{\lambda}e^{-\frac{T_i}{\lambda}})\]</span> <span class="math display">\[l(\lambda|T_1,T_2,...,T_n)=-nlog{\lambda}-\frac{\sum_{i=1}^nT_i}{\lambda}\]</span></li>
<li>E-step: <span class="math inline">\(E_{\hat \lambda_0}[l(\lambda|T_1,T_2,...,T_n)|T_1,T_2,...,T_r,1,...,1]=-nlog\lambda-\frac{\sum_{i=1}^rT_i+(n-r)+(n-r){\hat\lambda_0}}{\lambda}\)</span></li>
<li>M-step: <span class="math inline">\(\hat \lambda_1=\frac{\sum_{i=1}^rT_i+(n-r)+(n-r)\hat\lambda_0}{n}\)</span>.</li>
<li>The converged <span class="math inline">\(p\)</span> estimate (monotone, bounded) is the solution of the equation <span class="math display">\[\lambda=\frac{\sum_{i=1}^rT_i+(n-r)+(n-r)\lambda}{n}\Rightarrow  \tilde \lambda=\frac{\sum_{i=1}^rT_i+n-r}{r}==\frac{6.75}{7}=0.964285\]</span></li>
<li>The EM estimate is exactly the observed data MLE!</li>
</ul></li>
</ul>
<div id="tenth-homework" class="section level4">
<h4>tenth homework</h4>
</div>
</div>
<div id="question-7" class="section level3">
<h3>Question</h3>
<p>1.Why are the following two invocations of lapply() equivalent?</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">trims&lt;-<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb78-2" title="2">x&lt;-<span class="kw">rcauchy</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb78-3" title="3"><span class="kw">lapply</span>(trims,<span class="cf">function</span>(trim)<span class="kw">mean</span>(x,<span class="dt">trim=</span>trim))</a></code></pre></div>
<pre><code>## [[1]]
## [1] -1.396247
## 
## [[2]]
## [1] 0.1779981
## 
## [[3]]
## [1] 0.08534336
## 
## [[4]]
## [1] -0.06115359</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">lapply</span>(trims, mean, <span class="dt">x=</span>x)</a></code></pre></div>
<pre><code>## [[1]]
## [1] -1.396247
## 
## [[2]]
## [1] 0.1779981
## 
## [[3]]
## [1] 0.08534336
## 
## [[4]]
## [1] -0.06115359</code></pre>
</div>
<div id="answer-20" class="section level3">
<h3>Answer</h3>
<p>Because we write the function(trim) mean(x, trim = trim), which is equal to we we use mean(x,trim=trims) directly, In the later, we vary a argument, trims is not the first argument for mean() for we denote x=x.</p>
</div>
<div id="question-8" class="section level3">
<h3>Question</h3>
<ol start="5" style="list-style-type: decimal">
<li>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</li>
</ol>
</div>
<div id="answer-21" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co">##(5)</span></a>
<a class="sourceLine" id="cb82-2" title="2">rsq&lt;-<span class="cf">function</span>(mod){<span class="kw">summary</span>(mod)<span class="op">$</span>r.squared}</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="co">###3. Use both for loops and lapply() to fit linear models to the</span></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="co">#mtcars using the formulas stored in this list:</span></a>
<a class="sourceLine" id="cb82-5" title="5">data1&lt;-mtcars</a>
<a class="sourceLine" id="cb82-6" title="6">formulas&lt;-<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb82-7" title="7"> mpg<span class="op">~</span>disp,</a>
<a class="sourceLine" id="cb82-8" title="8"> mpg<span class="op">~</span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp),</a>
<a class="sourceLine" id="cb82-9" title="9"> mpg<span class="op">~</span>disp<span class="op">+</span>wt,</a>
<a class="sourceLine" id="cb82-10" title="10"> mpg<span class="op">~</span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp)<span class="op">+</span>wt</a>
<a class="sourceLine" id="cb82-11" title="11">)</a>
<a class="sourceLine" id="cb82-12" title="12">l1&lt;-<span class="kw">lapply</span>(formulas,lm,<span class="dt">data=</span>data1)</a>
<a class="sourceLine" id="cb82-13" title="13"><span class="kw">print</span>(<span class="st">&quot;In Exercise 3, the R^2 for each model is below&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;In Exercise 3, the R^2 for each model is below&quot;</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">lapply</span>(l1,rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="co">### 4. Fit the model mpg~disp to each of the bootstrap replicatesof mtcars in #the list below by using a for loop and lapply(). Can you do it without an #anonymous function?</span></a>
<a class="sourceLine" id="cb86-2" title="2">bootstraps&lt;-<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb86-3" title="3">    rows&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars),<span class="dt">rep=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb86-4" title="4">    mtcars[rows,]</a>
<a class="sourceLine" id="cb86-5" title="5">  })</a>
<a class="sourceLine" id="cb86-6" title="6">l2&lt;-<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</a>
<a class="sourceLine" id="cb86-7" title="7"><span class="kw">print</span>(<span class="st">&quot;In  Exercise 4, the R^2 for each model is below&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;In  Exercise 4, the R^2 for each model is below&quot;</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">lapply</span>(l2, rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.629107
## 
## [[2]]
## [1] 0.775777
## 
## [[3]]
## [1] 0.686455
## 
## [[4]]
## [1] 0.7659514
## 
## [[5]]
## [1] 0.7307956
## 
## [[6]]
## [1] 0.8118327
## 
## [[7]]
## [1] 0.7707617
## 
## [[8]]
## [1] 0.7057617
## 
## [[9]]
## [1] 0.7930436
## 
## [[10]]
## [1] 0.7004735</code></pre>
<p>For each model in the previous two exercises, the <span class="math inline">\(R^2\)</span> are above.</p>
</div>
<div id="question-9" class="section level3">
<h3>Question</h3>
<ol style="list-style-type: decimal">
<li>Use vapply() to:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data frame.</li>
<li>Compute the standard deviation of every numeric column in a mixed data frame. (Hint: youll need to use vapply() twice.)</li>
</ol>
</div>
<div id="answer-22" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co">#(a)the standard deviation of every column in a numeric data frame.</span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="kw">vapply</span>(data1,sd,<span class="dt">FUN.VALUE=</span><span class="kw">c</span>(<span class="dt">sd=</span><span class="dv">0</span>))</a></code></pre></div>
<pre><code>##         mpg         cyl        disp          hp        drat          wt 
##   6.0269481   1.7859216 123.9386938  68.5628685   0.5346787   0.9784574 
##        qsec          vs          am        gear        carb 
##   1.7869432   0.5040161   0.4989909   0.7378041   1.6152000</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="co">#(b)the standard deviation of every numeric column in a mixed data frame.</span></a>
<a class="sourceLine" id="cb92-2" title="2">data2&lt;-esoph</a>
<a class="sourceLine" id="cb92-3" title="3">summary1&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb92-4" title="4"><span class="kw">vapply</span>(x,as.numeric,<span class="dt">FUN.VALUE=</span><span class="kw">c</span>(<span class="dt">value1=</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb92-5" title="5">}</a>
<a class="sourceLine" id="cb92-6" title="6"><span class="kw">round</span>(<span class="kw">vapply</span>(data2,<span class="cf">function</span>(x)(<span class="kw">sd</span>(<span class="kw">summary1</span>(x))),<span class="dt">FUN.VALUE=</span><span class="kw">c</span>(<span class="dt">sd=</span><span class="dv">0</span>)),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##     agegp     alcgp     tobgp    ncases ncontrols 
##     1.650     1.124     1.121     2.753    12.135</code></pre>
<p>In above, we can see, if the data is numeric, we use vapply function only once, if the data is mix,for example in (b), data esoph is a mixture data, we should use vapply function twice.</p>
</div>
<div id="question-10" class="section level3">
<h3>Question</h3>
<ol start="7" style="list-style-type: decimal">
<li>Implement mcsapply(),a multicore version of sapply().Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</li>
</ol>
</div>
<div id="answer-23" class="section level3">
<h3>Answer</h3>
<p>The mcsapply() and mcvapply() as follow.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb94-2" title="2">n&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb94-3" title="3">cl&lt;-<span class="kw">makeCluster</span>(mc &lt;-<span class="kw">getOption</span>(<span class="st">&quot;cl.cores&quot;</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb94-4" title="4"><span class="kw">parLapply</span>(cl,<span class="dv">1</span><span class="op">:</span>n,sqrt)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 1.414214
## 
## [[3]]
## [1] 1.732051
## 
## [[4]]
## [1] 2
## 
## [[5]]
## [1] 2.236068
## 
## [[6]]
## [1] 2.44949
## 
## [[7]]
## [1] 2.645751
## 
## [[8]]
## [1] 2.828427
## 
## [[9]]
## [1] 3
## 
## [[10]]
## [1] 3.162278</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="co">#### we write the mcsapply based parLapply</span></a>
<a class="sourceLine" id="cb96-2" title="2">mcsapply&lt;-<span class="cf">function</span>(<span class="dt">cl=</span><span class="ot">NULL</span>,X, fun, ...) {</a>
<a class="sourceLine" id="cb96-3" title="3">  </a>
<a class="sourceLine" id="cb96-4" title="4">     res&lt;-<span class="kw">parLapply</span>(cl,X, fun, ...)</a>
<a class="sourceLine" id="cb96-5" title="5">     <span class="kw">simplify2array</span>(res)</a>
<a class="sourceLine" id="cb96-6" title="6">}</a>
<a class="sourceLine" id="cb96-7" title="7">mcvapply&lt;-<span class="cf">function</span>(cl,X, fun, fun.value,...){</a>
<a class="sourceLine" id="cb96-8" title="8">    </a>
<a class="sourceLine" id="cb96-9" title="9">     fun1&lt;-<span class="cf">function</span>(x)x</a>
<a class="sourceLine" id="cb96-10" title="10">     <span class="kw">vapply</span>(<span class="kw">parLapply</span>(cl,X,fun),fun1,<span class="dt">FUN.VALUE=</span>fun.value,...)</a>
<a class="sourceLine" id="cb96-11" title="11">}</a>
<a class="sourceLine" id="cb96-12" title="12"><span class="kw">mcsapply</span>(cl,<span class="dv">1</span><span class="op">:</span>n,sqrt)</a></code></pre></div>
<pre><code>##  [1] 1.000000 1.414214 1.732051 2.000000 2.236068 2.449490 2.645751 2.828427
##  [9] 3.000000 3.162278</code></pre>
<div id="eleventh-homework" class="section level4">
<h4>eleventh homework</h4>
</div>
</div>
<div id="question1" class="section level3">
<h3>Question1</h3>
<p>Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R)</p>
</div>
<div id="answer1" class="section level3">
<h3>Answer1</h3>
<p>I write a Rcpp function for the Exercise 9.8 as follow.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="co">#include &lt;Rcpp.h&gt;</span></a>
<a class="sourceLine" id="cb98-2" title="2">using namespace Rcpp;</a>
<a class="sourceLine" id="cb98-3" title="3"><span class="op">/</span><span class="er">/</span>[[Rcpp<span class="op">::</span>export]]</a>
<a class="sourceLine" id="cb98-4" title="4">NumericMatrix <span class="kw">gibbsC</span>(int a,int b,int n) {</a>
<a class="sourceLine" id="cb98-5" title="5">  int N =<span class="st"> </span><span class="dv">10000</span>;</a>
<a class="sourceLine" id="cb98-6" title="6">  NumericMatrix <span class="kw">X</span>(N,<span class="dv">2</span>);</a>
<a class="sourceLine" id="cb98-7" title="7">  double x=<span class="dv">0</span>,y=<span class="dv">0</span>;</a>
<a class="sourceLine" id="cb98-8" title="8">  <span class="kw">X</span>(<span class="dv">0</span>,<span class="dv">0</span>)=<span class="dv">0</span>;</a>
<a class="sourceLine" id="cb98-9" title="9">  <span class="kw">X</span>(<span class="dv">0</span>,<span class="dv">1</span>)=<span class="fl">0.3</span>;</a>
<a class="sourceLine" id="cb98-10" title="10">  <span class="cf">for</span>(int <span class="dt">i=</span><span class="dv">1</span>; i<span class="op">&lt;</span>N; <span class="op">++</span>i) {</a>
<a class="sourceLine" id="cb98-11" title="11">    y=<span class="kw">X</span>(i<span class="dv">-1</span>,<span class="dv">1</span>);</a>
<a class="sourceLine" id="cb98-12" title="12">    <span class="kw">X</span>(i,<span class="dv">0</span>)=<span class="kw">rbinom</span>(<span class="dv">1</span>,n,y)[<span class="dv">0</span>];</a>
<a class="sourceLine" id="cb98-13" title="13">    x=<span class="kw">X</span>(i,<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb98-14" title="14">    <span class="kw">X</span>(i,<span class="dv">1</span>)=<span class="kw">rbeta</span>(<span class="dv">1</span>,x<span class="op">+</span>a,n<span class="op">-</span>x<span class="op">+</span>b)[<span class="dv">0</span>];</a>
<a class="sourceLine" id="cb98-15" title="15">  }</a>
<a class="sourceLine" id="cb98-16" title="16">  <span class="kw">return</span> (X);</a>
<a class="sourceLine" id="cb98-17" title="17">} </a></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb99-2" title="2"><span class="kw">library</span>(StatComp21027)</a>
<a class="sourceLine" id="cb99-3" title="3"> m&lt;-<span class="kw">gibbsC</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb99-4" title="4"> <span class="kw">plot</span>(m[,<span class="dv">1</span>],m[,<span class="dv">2</span>])</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question2" class="section level3">
<h3>Question2</h3>
<p>Compare the corresponding generated random numbers with pure R language using the function qplot?.</p>
</div>
<div id="answer2" class="section level3">
<h3>Answer2</h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">    <span class="kw">set.seed</span>(<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb100-2" title="2">    x_C&lt;-<span class="kw">gibbsC</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb100-3" title="3">    y_R&lt;-<span class="kw">gibbsR</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb100-4" title="4"><span class="co">## we will draw the qqplot</span></a>
<a class="sourceLine" id="cb100-5" title="5">c&lt;-<span class="kw">ppoints</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb100-6" title="6">QC1&lt;-<span class="kw">quantile</span>(x_C[,<span class="dv">1</span>],c)</a>
<a class="sourceLine" id="cb100-7" title="7">QR1&lt;-<span class="kw">quantile</span>(y_R[,<span class="dv">1</span>],c)</a>
<a class="sourceLine" id="cb100-8" title="8">QC2&lt;-<span class="kw">quantile</span>(x_C[,<span class="dv">2</span>],c)</a>
<a class="sourceLine" id="cb100-9" title="9">QR2&lt;-<span class="kw">quantile</span>(y_R[,<span class="dv">2</span>],c)</a>
<a class="sourceLine" id="cb100-10" title="10"> <span class="kw">qqplot</span>(QC1,QR1,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;QC1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;QR1&quot;</span>)</a>
<a class="sourceLine" id="cb100-11" title="11"> <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"> <span class="kw">qqplot</span>(QC2,QR2,<span class="dt">main=</span><span class="st">&quot;&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;QC2&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;QR2&quot;</span>)</a>
<a class="sourceLine" id="cb101-2" title="2"> <span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As can be seen from the QQ chart, the quantiles of the two samples are roughly the same, so their distribution is also roughly the same.</p>
</div>
<div id="question3" class="section level3">
<h3>Question3</h3>
<p>Campare the computation time of the two functions with the function microbenchmark ?.</p>
</div>
<div id="answer3" class="section level3">
<h3>Answer3</h3>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb102-2" title="2">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">gibbR=</span><span class="kw">gibbsR</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">100</span>),</a>
<a class="sourceLine" id="cb102-3" title="3"><span class="dt">gibbC=</span><span class="kw">gibbsC</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb102-4" title="4"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##    expr       lq   median       uq
## 1 gibbR 45.13160 53.78035 57.79765
## 2 gibbC  9.29915  9.89230 10.93245</code></pre>
<p>Campare the computation time of the two functions gibbsC and gibbsR we can see, the time of C++ to loop is less than R obviously.</p>
</div>
<div id="question4" class="section level3">
<h3>Question4</h3>
<p>Comments your results.</p>
</div>
<div id="answer4" class="section level3">
<h3>Answer4</h3>
<p>Each programming language has its own specific advantages, and we should make full use of the advantages of each language and use multiple programming languages together to create more efficient and convenient code.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
